[0m14:51:38.456563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514E2F92D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002515018F070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002515018E5F0>]}


============================== 14:51:38.464569 | 0d6f20b8-d94e-4dda-94c9-020e1cdf103a ==============================
[0m14:51:38.464569 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:51:38.465071 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '..', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir ..', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'logs'}
[0m14:51:38.465814 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\limoi\Documents\energyops\dbt\energyops\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m14:51:38.466895 [debug] [MainThread]: Command `dbt run` failed at 14:51:38.466895 after 0.07 seconds
[0m14:51:38.466895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002514E2F92D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002515018CB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002515018DE70>]}
[0m14:51:38.466895 [debug] [MainThread]: Flushing usage events
[0m14:51:38.871385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:51:40.261385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C578CF9210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C579B52CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C579B52920>]}


============================== 14:51:40.265128 | f45577a2-23e9-41ca-bf22-4a441e8b0601 ==============================
[0m14:51:40.265128 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:51:40.265128 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '..', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --profiles-dir ..', 'use_experimental_parser': 'False', 'log_path': 'logs'}
[0m14:51:40.265945 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\limoi\Documents\energyops\dbt\energyops\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m14:51:40.267107 [debug] [MainThread]: Command `dbt test` failed at 14:51:40.265945 after 0.07 seconds
[0m14:51:40.267107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C578CF9210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C579B53EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C579B52CE0>]}
[0m14:51:40.267107 [debug] [MainThread]: Flushing usage events
[0m14:51:40.631095 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:03.631392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172777F52A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727968E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727968F4F0>]}


============================== 15:46:03.641936 | d2a01021-8672-4238-b341-5002770ce2fa ==============================
[0m15:46:03.641936 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:46:03.642942 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '..', 'invocation_command': 'dbt run --profiles-dir ..', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'logs'}
[0m15:46:03.643947 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\limoi\Documents\energyops\dbt\energyops\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m15:46:03.644947 [debug] [MainThread]: Command `dbt run` failed at 15:46:03.644947 after 0.08 seconds
[0m15:46:03.644947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172777F52A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727968FD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727968F820>]}
[0m15:46:03.644947 [debug] [MainThread]: Flushing usage events
[0m15:46:04.097772 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:05.560432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2A04851E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2A2352CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2A2353490>]}


============================== 15:46:05.562936 | 8276cabe-5f95-4b6c-8329-0e58e263ddd9 ==============================
[0m15:46:05.562936 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:46:05.563937 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '..', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt test --profiles-dir ..', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'logs'}
[0m15:46:05.563937 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\limoi\Documents\energyops\dbt\energyops\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m15:46:05.564936 [debug] [MainThread]: Command `dbt test` failed at 15:46:05.564936 after 0.06 seconds
[0m15:46:05.564936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2A04851E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2A2353EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2A2352CE0>]}
[0m15:46:05.564936 [debug] [MainThread]: Flushing usage events
[0m15:46:05.937058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:10.992596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7779791cb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77797aad9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7779793a1fa0>]}


============================== 15:22:10.997816 | d3a73f77-7388-461d-9c60-01e45755c3c8 ==============================
[0m15:22:10.997816 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:22:10.998780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:11.027067 [info ] [MainThread]: dbt version: 1.9.0
[0m15:22:11.028021 [info ] [MainThread]: python version: 3.12.4
[0m15:22:11.028755 [info ] [MainThread]: python path: /usr/local/bin/python
[0m15:22:11.029371 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m15:22:11.067649 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m15:22:11.068585 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m15:22:11.069318 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m15:22:11.070105 [info ] [MainThread]: adapter type: postgres
[0m15:22:11.070702 [info ] [MainThread]: adapter version: 1.9.0
[0m15:22:11.071471 [info ] [MainThread]: Configuration:
[0m15:22:11.072082 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:22:11.072695 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m15:22:11.073252 [info ] [MainThread]: Required dependencies:
[0m15:22:11.074135 [debug] [MainThread]: Executing "git --help"
[0m15:22:11.076208 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:22:11.077000 [debug] [MainThread]: STDERR: "b''"
[0m15:22:11.077613 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:22:11.078204 [info ] [MainThread]: Connection:
[0m15:22:11.078898 [info ] [MainThread]:   host: postgres
[0m15:22:11.080222 [info ] [MainThread]:   port: 5432
[0m15:22:11.081402 [info ] [MainThread]:   user: energy
[0m15:22:11.082278 [info ] [MainThread]:   database: energyops
[0m15:22:11.083037 [info ] [MainThread]:   schema: analytics
[0m15:22:11.083684 [info ] [MainThread]:   connect_timeout: 10
[0m15:22:11.084481 [info ] [MainThread]:   role: None
[0m15:22:11.085133 [info ] [MainThread]:   search_path: None
[0m15:22:11.085763 [info ] [MainThread]:   keepalives_idle: 0
[0m15:22:11.086333 [info ] [MainThread]:   sslmode: None
[0m15:22:11.086940 [info ] [MainThread]:   sslcert: None
[0m15:22:11.087495 [info ] [MainThread]:   sslkey: None
[0m15:22:11.088206 [info ] [MainThread]:   sslrootcert: None
[0m15:22:11.088955 [info ] [MainThread]:   application_name: dbt
[0m15:22:11.089773 [info ] [MainThread]:   retries: 1
[0m15:22:11.090633 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:22:11.125626 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:22:11.143568 [debug] [MainThread]: Using postgres connection "debug"
[0m15:22:11.144470 [debug] [MainThread]: On debug: select 1 as id
[0m15:22:11.145074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:11.153098 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m15:22:11.154183 [debug] [MainThread]: On debug: Close
[0m15:22:11.154852 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:22:11.155627 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:22:11.156515 [info ] [MainThread]: Project loading failed for the following reason:
 project path </usr/app/dbt_project.yml> not found

[0m15:22:11.157594 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.22176047, "process_in_blocks": "0", "process_kernel_time": 0.112754, "process_mem_max_rss": "98816", "process_out_blocks": "1496", "process_user_time": 0.906059}
[0m15:22:11.158314 [debug] [MainThread]: Command `dbt debug` failed at 15:22:11.158231 after 0.22 seconds
[0m15:22:11.158859 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:22:11.159447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7779790b6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777978bd2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777978c17740>]}
[0m15:22:11.160037 [debug] [MainThread]: Flushing usage events
[0m15:22:11.558812 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:13.262654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c37e87680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c383403b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c374d97f0>]}


============================== 15:22:13.268040 | 09c1c771-439e-4a74-9557-089a608ae6de ==============================
[0m15:22:13.268040 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:22:13.268885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:22:13.269598 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m15:22:13.271178 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.04597743, "process_in_blocks": "0", "process_kernel_time": 0.09982, "process_mem_max_rss": "86944", "process_out_blocks": "1472", "process_user_time": 0.778596}
[0m15:22:13.271900 [debug] [MainThread]: Command `dbt run` failed at 15:22:13.271812 after 0.05 seconds
[0m15:22:13.272488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c3763ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c3758d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c37e87680>]}
[0m15:22:13.273076 [debug] [MainThread]: Flushing usage events
[0m15:22:13.654827 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:15.500613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e62322a4c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e62325ed070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e623255aed0>]}


============================== 15:22:15.511638 | e6e2d4dc-b8a1-4453-bc7e-746db1d9f006 ==============================
[0m15:22:15.511638 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:22:15.512728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:22:15.514101 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m15:22:15.516777 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.08986247, "process_in_blocks": "0", "process_kernel_time": 0.128957, "process_mem_max_rss": "86928", "process_out_blocks": "1472", "process_user_time": 0.769718}
[0m15:22:15.521337 [debug] [MainThread]: Command `dbt test` failed at 15:22:15.521245 after 0.09 seconds
[0m15:22:15.522994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e62325c0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e623578a900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e62326c98e0>]}
[0m15:22:15.525763 [debug] [MainThread]: Flushing usage events
[0m15:22:15.891432 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:23.126793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c8c4c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c8bbc140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c77b8ef0>]}


============================== 15:26:23.134393 | fc2556be-98d4-471d-901e-73b06e233fce ==============================
[0m15:26:23.134393 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:26:23.135721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:26:23.174305 [info ] [MainThread]: dbt version: 1.9.0
[0m15:26:23.175706 [info ] [MainThread]: python version: 3.12.4
[0m15:26:23.177150 [info ] [MainThread]: python path: /usr/local/bin/python
[0m15:26:23.180474 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m15:26:23.250561 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m15:26:23.251797 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m15:26:23.252832 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m15:26:23.254028 [info ] [MainThread]: adapter type: postgres
[0m15:26:23.254677 [info ] [MainThread]: adapter version: 1.9.0
[0m15:26:23.255442 [info ] [MainThread]: Configuration:
[0m15:26:23.256030 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:26:23.256696 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m15:26:23.257481 [info ] [MainThread]: Required dependencies:
[0m15:26:23.258275 [debug] [MainThread]: Executing "git --help"
[0m15:26:23.268539 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:26:23.269756 [debug] [MainThread]: STDERR: "b''"
[0m15:26:23.270993 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:26:23.271748 [info ] [MainThread]: Connection:
[0m15:26:23.273149 [info ] [MainThread]:   host: postgres
[0m15:26:23.274157 [info ] [MainThread]:   port: 5432
[0m15:26:23.274885 [info ] [MainThread]:   user: energy
[0m15:26:23.275531 [info ] [MainThread]:   database: energyops
[0m15:26:23.276107 [info ] [MainThread]:   schema: analytics
[0m15:26:23.276725 [info ] [MainThread]:   connect_timeout: 10
[0m15:26:23.277510 [info ] [MainThread]:   role: None
[0m15:26:23.278144 [info ] [MainThread]:   search_path: None
[0m15:26:23.279126 [info ] [MainThread]:   keepalives_idle: 0
[0m15:26:23.279977 [info ] [MainThread]:   sslmode: None
[0m15:26:23.280879 [info ] [MainThread]:   sslcert: None
[0m15:26:23.281751 [info ] [MainThread]:   sslkey: None
[0m15:26:23.282420 [info ] [MainThread]:   sslrootcert: None
[0m15:26:23.283091 [info ] [MainThread]:   application_name: dbt
[0m15:26:23.283751 [info ] [MainThread]:   retries: 1
[0m15:26:23.284743 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:26:23.325476 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:26:23.346975 [debug] [MainThread]: Using postgres connection "debug"
[0m15:26:23.347784 [debug] [MainThread]: On debug: select 1 as id
[0m15:26:23.348400 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:23.367734 [debug] [MainThread]: SQL status: SELECT 1 in 0.019 seconds
[0m15:26:23.369019 [debug] [MainThread]: On debug: Close
[0m15:26:23.369753 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:26:23.372004 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:26:23.373164 [info ] [MainThread]: Project loading failed for the following reason:
 project path </usr/app/dbt_project.yml> not found

[0m15:26:23.374940 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.36830568, "process_in_blocks": "17696", "process_kernel_time": 0.165341, "process_mem_max_rss": "98476", "process_out_blocks": "1496", "process_user_time": 0.850327}
[0m15:26:23.378821 [debug] [MainThread]: Command `dbt debug` failed at 15:26:23.378601 after 0.37 seconds
[0m15:26:23.380331 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:26:23.381692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c8c4c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c6e0f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7708c7053830>]}
[0m15:26:23.382871 [debug] [MainThread]: Flushing usage events
[0m15:26:23.788916 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:25.776413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b82214e4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8221e2ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8221761a60>]}


============================== 15:26:25.781534 | 4aaf3bf7-7f0b-45bd-a55e-75361394f6cd ==============================
[0m15:26:25.781534 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:26:25.782740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:26:25.783628 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m15:26:25.785252 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.043724805, "process_in_blocks": "8", "process_kernel_time": 0.072168, "process_mem_max_rss": "86988", "process_out_blocks": "1472", "process_user_time": 0.805881}
[0m15:26:25.786026 [debug] [MainThread]: Command `dbt run` failed at 15:26:25.785945 after 0.04 seconds
[0m15:26:25.786596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8224c26900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8221715f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b82214e6f30>]}
[0m15:26:25.787238 [debug] [MainThread]: Flushing usage events
[0m15:26:26.165900 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:28.050579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e001405d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e001a5a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e0012a8a70>]}


============================== 15:26:28.055721 | bfdea22e-a19e-4e3e-b190-2b2f99dc8d82 ==============================
[0m15:26:28.055721 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:26:28.057295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:26:28.058092 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m15:26:28.059177 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.042957637, "process_in_blocks": "0", "process_kernel_time": 0.111981, "process_mem_max_rss": "86392", "process_out_blocks": "1472", "process_user_time": 0.747874}
[0m15:26:28.059836 [debug] [MainThread]: Command `dbt test` failed at 15:26:28.059759 after 0.04 seconds
[0m15:26:28.060449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e000d8fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e000d8fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e001307290>]}
[0m15:26:28.061041 [debug] [MainThread]: Flushing usage events
[0m15:26:28.428044 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:35.426823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708875f618b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70887673cf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088763eb650>]}


============================== 15:44:35.433655 | d744a965-ea46-4e34-96b3-0297010c17ca ==============================
[0m15:44:35.433655 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:44:35.436968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:44:35.480280 [info ] [MainThread]: dbt version: 1.9.0
[0m15:44:35.481757 [info ] [MainThread]: python version: 3.12.4
[0m15:44:35.482822 [info ] [MainThread]: python path: /usr/local/bin/python
[0m15:44:35.483753 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m15:44:35.553118 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m15:44:35.554279 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m15:44:35.555048 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m15:44:35.556228 [info ] [MainThread]: adapter type: postgres
[0m15:44:35.556974 [info ] [MainThread]: adapter version: 1.9.0
[0m15:44:35.627135 [info ] [MainThread]: Configuration:
[0m15:44:35.628420 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:44:35.629418 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:44:35.630485 [info ] [MainThread]: Required dependencies:
[0m15:44:35.631330 [debug] [MainThread]: Executing "git --help"
[0m15:44:35.639932 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:44:35.640732 [debug] [MainThread]: STDERR: "b''"
[0m15:44:35.641269 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:44:35.641900 [info ] [MainThread]: Connection:
[0m15:44:35.643281 [info ] [MainThread]:   host: postgres
[0m15:44:35.644014 [info ] [MainThread]:   port: 5432
[0m15:44:35.644674 [info ] [MainThread]:   user: energy
[0m15:44:35.645489 [info ] [MainThread]:   database: energyops
[0m15:44:35.646296 [info ] [MainThread]:   schema: analytics
[0m15:44:35.647513 [info ] [MainThread]:   connect_timeout: 10
[0m15:44:35.648495 [info ] [MainThread]:   role: None
[0m15:44:35.649623 [info ] [MainThread]:   search_path: None
[0m15:44:35.650505 [info ] [MainThread]:   keepalives_idle: 0
[0m15:44:35.651421 [info ] [MainThread]:   sslmode: None
[0m15:44:35.652082 [info ] [MainThread]:   sslcert: None
[0m15:44:35.652778 [info ] [MainThread]:   sslkey: None
[0m15:44:35.654276 [info ] [MainThread]:   sslrootcert: None
[0m15:44:35.655187 [info ] [MainThread]:   application_name: dbt
[0m15:44:35.655984 [info ] [MainThread]:   retries: 1
[0m15:44:35.656823 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:44:35.695887 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:44:35.716187 [debug] [MainThread]: Using postgres connection "debug"
[0m15:44:35.717010 [debug] [MainThread]: On debug: select 1 as id
[0m15:44:35.717684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:44:35.744749 [debug] [MainThread]: SQL status: SELECT 1 in 0.027 seconds
[0m15:44:35.747199 [debug] [MainThread]: On debug: Close
[0m15:44:35.748051 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:44:35.749322 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:44:35.753204 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.382526, "process_in_blocks": "17664", "process_kernel_time": 0.121845, "process_mem_max_rss": "101224", "process_out_blocks": "1496", "process_user_time": 1.043807}
[0m15:44:35.754171 [debug] [MainThread]: Command `dbt debug` succeeded at 15:44:35.753983 after 0.38 seconds
[0m15:44:35.754780 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:44:35.755393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708877b3c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70887401bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088742cebd0>]}
[0m15:44:35.756020 [debug] [MainThread]: Flushing usage events
[0m15:44:36.152290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:38.340280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc310305d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc3100db740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc31067ec30>]}


============================== 15:44:38.345946 | 9ac8ec30-e032-4766-872e-89f08bce1a8b ==============================
[0m15:44:38.345946 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:44:38.346840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:44:38.516273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ac8ec30-e032-4766-872e-89f08bce1a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc3112956a0>]}
[0m15:44:38.560389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ac8ec30-e032-4766-872e-89f08bce1a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc3108e96a0>]}
[0m15:44:38.562494 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:44:38.609766 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:44:38.612865 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:44:38.613737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9ac8ec30-e032-4766-872e-89f08bce1a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc30fff1430>]}
[0m15:44:38.723149 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models/dbt_project.yml is invalid because the value of 'models' is not a list
[0m15:44:38.724466 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.42903107, "process_in_blocks": "520", "process_kernel_time": 0.166146, "process_mem_max_rss": "93648", "process_out_blocks": "1496", "process_user_time": 0.992923}
[0m15:44:38.725352 [debug] [MainThread]: Command `dbt run` failed at 15:44:38.725245 after 0.43 seconds
[0m15:44:38.726057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc31006ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc30e46bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc310a0a510>]}
[0m15:44:38.726680 [debug] [MainThread]: Flushing usage events
[0m15:44:39.092259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:41.288166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b77dc8a4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b77dc87c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b77dddc82c0>]}


============================== 15:44:41.293156 | f5a51b97-430d-4b5a-80d5-97aee25263f6 ==============================
[0m15:44:41.293156 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:44:41.294236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:44:41.428861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5a51b97-430d-4b5a-80d5-97aee25263f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b77dc4e67b0>]}
[0m15:44:41.469413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5a51b97-430d-4b5a-80d5-97aee25263f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b77dab28470>]}
[0m15:44:41.470814 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:44:41.514975 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:44:41.517188 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:44:41.517896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f5a51b97-430d-4b5a-80d5-97aee25263f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b77dcb84f20>]}
[0m15:44:41.581873 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models/dbt_project.yml is invalid because the value of 'models' is not a list
[0m15:44:41.583404 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.3366714, "process_in_blocks": "8", "process_kernel_time": 0.127084, "process_mem_max_rss": "92484", "process_out_blocks": "1496", "process_user_time": 1.032559}
[0m15:44:41.584399 [debug] [MainThread]: Command `dbt test` failed at 15:44:41.584293 after 0.34 seconds
[0m15:44:41.585180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b77dd59ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b77dc510350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b77dab2b6e0>]}
[0m15:44:41.586047 [debug] [MainThread]: Flushing usage events
[0m15:44:41.952669 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:06.549003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c8e8d6660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c8f126240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c8f0af830>]}


============================== 15:46:06.555589 | cc58704f-ab5c-46e7-a92e-e8bd2d5e3a3c ==============================
[0m15:46:06.555589 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:46:06.557081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:46:06.728693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc58704f-ab5c-46e7-a92e-e8bd2d5e3a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c8e49c260>]}
[0m15:46:06.769226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc58704f-ab5c-46e7-a92e-e8bd2d5e3a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c8e512420>]}
[0m15:46:06.770695 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:46:06.815128 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:46:06.817394 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:46:06.818100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cc58704f-ab5c-46e7-a92e-e8bd2d5e3a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c8cbd0fe0>]}
[0m15:46:07.609591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc58704f-ab5c-46e7-a92e-e8bd2d5e3a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c8c981ac0>]}
[0m15:46:07.670924 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:46:07.675807 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:46:07.714475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc58704f-ab5c-46e7-a92e-e8bd2d5e3a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c8c803890>]}
[0m15:46:07.715685 [info ] [MainThread]: Found 3 models, 4 data tests, 429 macros
[0m15:46:07.716637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc58704f-ab5c-46e7-a92e-e8bd2d5e3a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c8cbd3b90>]}
[0m15:46:07.718544 [info ] [MainThread]: 
[0m15:46:07.719613 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:46:07.720594 [info ] [MainThread]: 
[0m15:46:07.721676 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:46:07.725416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_energyops'
[0m15:46:07.751215 [debug] [ThreadPool]: Using postgres connection "list_energyops"
[0m15:46:07.752173 [debug] [ThreadPool]: On list_energyops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "list_energyops"} */

    select distinct nspname from pg_namespace
  
[0m15:46:07.752902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:07.774534 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.022 seconds
[0m15:46:07.776472 [debug] [ThreadPool]: On list_energyops: Close
[0m15:46:07.778076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_energyops, now list_energyops_analytics)
[0m15:46:07.782208 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:46:07.783043 [debug] [ThreadPool]: On list_energyops_analytics: BEGIN
[0m15:46:07.783659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:07.787981 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:46:07.789059 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:46:07.789914 [debug] [ThreadPool]: On list_energyops_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "list_energyops_analytics"} */
select
      'energyops' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:46:07.795786 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m15:46:07.797513 [debug] [ThreadPool]: On list_energyops_analytics: ROLLBACK
[0m15:46:07.798387 [debug] [ThreadPool]: On list_energyops_analytics: Close
[0m15:46:07.801693 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:07.802309 [debug] [MainThread]: On master: BEGIN
[0m15:46:07.803177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:46:07.807089 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:46:07.807699 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:07.808285 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:46:07.814059 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m15:46:07.815458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc58704f-ab5c-46e7-a92e-e8bd2d5e3a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c8c7a5fd0>]}
[0m15:46:07.816219 [debug] [MainThread]: On master: ROLLBACK
[0m15:46:07.816877 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:07.817453 [debug] [MainThread]: On master: BEGIN
[0m15:46:07.818163 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:46:07.818763 [debug] [MainThread]: On master: COMMIT
[0m15:46:07.819306 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:07.819850 [debug] [MainThread]: On master: COMMIT
[0m15:46:07.820467 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:46:07.820987 [debug] [MainThread]: On master: Close
[0m15:46:07.823069 [debug] [Thread-1 (]: Began running node model.energyops.stg_supplier_meter_readings
[0m15:46:07.823903 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stg_supplier_meter_readings .............. [RUN]
[0m15:46:07.824738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_energyops_analytics, now model.energyops.stg_supplier_meter_readings)
[0m15:46:07.825341 [debug] [Thread-1 (]: Began compiling node model.energyops.stg_supplier_meter_readings
[0m15:46:07.829126 [debug] [Thread-1 (]: Writing injected SQL for node "model.energyops.stg_supplier_meter_readings"
[0m15:46:07.839663 [debug] [Thread-1 (]: Began executing node model.energyops.stg_supplier_meter_readings
[0m15:46:07.908770 [debug] [Thread-1 (]: Writing runtime sql for node "model.energyops.stg_supplier_meter_readings"
[0m15:46:07.921400 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:46:07.922623 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: BEGIN
[0m15:46:07.923505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:07.927773 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:46:07.928954 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:46:07.930782 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */

  create view "energyops"."analytics"."stg_supplier_meter_readings__dbt_tmp"
    
    
  as (
    select
  period_start,
  period_end,
  trim(reading_type) as reading_type,
  upper(trim(cadran)) as cadran,
  index_start,
  index_end,
  kwh::numeric(12,3) as kwh,
  (period_end - period_start + 1) as period_days
from raw.supplier_meter_readings
  );
[0m15:46:07.942571 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m15:46:07.947422 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:46:07.948073 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
alter table "energyops"."analytics"."stg_supplier_meter_readings__dbt_tmp" rename to "stg_supplier_meter_readings"
[0m15:46:07.949288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:46:07.958288 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: COMMIT
[0m15:46:07.959093 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:46:07.959773 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: COMMIT
[0m15:46:07.963287 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:46:07.967584 [debug] [Thread-1 (]: Applying DROP to: "energyops"."analytics"."stg_supplier_meter_readings__dbt_backup"
[0m15:46:07.971071 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:46:07.971869 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
drop view if exists "energyops"."analytics"."stg_supplier_meter_readings__dbt_backup" cascade
[0m15:46:07.973137 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:46:07.974996 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: Close
[0m15:46:07.976818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc58704f-ab5c-46e7-a92e-e8bd2d5e3a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c84744da0>]}
[0m15:46:07.977697 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stg_supplier_meter_readings ......... [[32mCREATE VIEW[0m in 0.15s]
[0m15:46:07.978634 [debug] [Thread-1 (]: Finished running node model.energyops.stg_supplier_meter_readings
[0m15:46:07.979712 [debug] [Thread-3 (]: Began running node model.energyops.fct_energy_period
[0m15:46:07.980455 [info ] [Thread-3 (]: 2 of 3 START sql table model analytics.fct_energy_period ....................... [RUN]
[0m15:46:07.981173 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.energyops.fct_energy_period'
[0m15:46:07.981823 [debug] [Thread-3 (]: Began compiling node model.energyops.fct_energy_period
[0m15:46:07.984134 [debug] [Thread-3 (]: Writing injected SQL for node "model.energyops.fct_energy_period"
[0m15:46:07.992816 [debug] [Thread-3 (]: Began executing node model.energyops.fct_energy_period
[0m15:46:08.006573 [debug] [Thread-3 (]: Writing runtime sql for node "model.energyops.fct_energy_period"
[0m15:46:08.013476 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:46:08.014104 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: BEGIN
[0m15:46:08.014826 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:46:08.019802 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m15:46:08.021837 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:46:08.023875 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */

  
    

  create  table "energyops"."analytics"."fct_energy_period__dbt_tmp"
  
  
    as
  
  (
    with base as (
  select
    period_start,
    period_end,
    max(period_days) as period_days,
    sum(kwh) filter (where cadran = 'HP') as kwh_hp,
    sum(kwh) filter (where cadran = 'HC') as kwh_hc
  from "energyops"."analytics"."stg_supplier_meter_readings"
  group by 1,2
),
tar as (
  select
    b.*,
    t.hp_eur_per_kwh,
    t.hc_eur_per_kwh
  from base b
  left join lateral (
    select hp_eur_per_kwh, hc_eur_per_kwh
    from config.tariff_hp_hc
    where effective_from <= b.period_end
    order by effective_from desc
    limit 1
  ) t on true
)
select
  period_start,
  period_end,
  period_days,
  coalesce(kwh_hp, 0) as kwh_hp,
  coalesce(kwh_hc, 0) as kwh_hc,
  (coalesce(kwh_hp,0) + coalesce(kwh_hc,0)) as kwh_total,
  ((coalesce(kwh_hp,0) + coalesce(kwh_hc,0)) / nullif(period_days,0))::numeric(12,3) as kwh_per_day_est,
  hp_eur_per_kwh,
  hc_eur_per_kwh,
  (coalesce(kwh_hp,0) * hp_eur_per_kwh + coalesce(kwh_hc,0) * hc_eur_per_kwh)::numeric(12,2) as cost_est_eur
from tar
order by period_end;
  );
  
[0m15:46:08.026547 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 48: order by period_end;
                            ^

[0m15:46:08.027307 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: ROLLBACK
[0m15:46:08.028072 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: Close
[0m15:46:08.033041 [debug] [Thread-3 (]: Database Error in model fct_energy_period (models/marts/fct_energy_period.sql)
  syntax error at or near ";"
  LINE 48: order by period_end;
                              ^
  compiled code at target/run/energyops/models/marts/fct_energy_period.sql
[0m15:46:08.033905 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc58704f-ab5c-46e7-a92e-e8bd2d5e3a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c8cbf1640>]}
[0m15:46:08.034732 [error] [Thread-3 (]: 2 of 3 ERROR creating sql table model analytics.fct_energy_period .............. [[31mERROR[0m in 0.05s]
[0m15:46:08.035576 [debug] [Thread-3 (]: Finished running node model.energyops.fct_energy_period
[0m15:46:08.036327 [debug] [Thread-7 (]: Marking all children of 'model.energyops.fct_energy_period' to be skipped because of status 'error'.  Reason: Database Error in model fct_energy_period (models/marts/fct_energy_period.sql)
  syntax error at or near ";"
  LINE 48: order by period_end;
                              ^
  compiled code at target/run/energyops/models/marts/fct_energy_period.sql.
[0m15:46:08.037728 [debug] [Thread-2 (]: Began running node model.energyops.agg_energy_calendar_month_est
[0m15:46:08.038366 [info ] [Thread-2 (]: 3 of 3 SKIP relation analytics.agg_energy_calendar_month_est ................... [[33mSKIP[0m]
[0m15:46:08.039116 [debug] [Thread-2 (]: Finished running node model.energyops.agg_energy_calendar_month_est
[0m15:46:08.040709 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:08.041334 [debug] [MainThread]: On master: BEGIN
[0m15:46:08.041904 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:46:08.045742 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:46:08.046722 [debug] [MainThread]: On master: COMMIT
[0m15:46:08.047718 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:08.048364 [debug] [MainThread]: On master: COMMIT
[0m15:46:08.049107 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:46:08.049689 [debug] [MainThread]: On master: Close
[0m15:46:08.050418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:08.050994 [debug] [MainThread]: Connection 'model.energyops.stg_supplier_meter_readings' was properly closed.
[0m15:46:08.051674 [debug] [MainThread]: Connection 'model.energyops.fct_energy_period' was properly closed.
[0m15:46:08.052416 [info ] [MainThread]: 
[0m15:46:08.053299 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m15:46:08.055208 [debug] [MainThread]: Command end result
[0m15:46:08.076524 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:46:08.082923 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:46:08.093696 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:46:08.094455 [info ] [MainThread]: 
[0m15:46:08.095710 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:46:08.096807 [info ] [MainThread]: 
[0m15:46:08.098472 [error] [MainThread]:   Database Error in model fct_energy_period (models/marts/fct_energy_period.sql)
  syntax error at or near ";"
  LINE 48: order by period_end;
                              ^
  compiled code at target/run/energyops/models/marts/fct_energy_period.sql
[0m15:46:08.099408 [info ] [MainThread]: 
[0m15:46:08.100906 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m15:46:08.103396 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5958394, "process_in_blocks": "102104", "process_kernel_time": 0.26513, "process_mem_max_rss": "112248", "process_out_blocks": "1608", "process_user_time": 1.996276}
[0m15:46:08.104761 [debug] [MainThread]: Command `dbt run` failed at 15:46:08.104655 after 1.60 seconds
[0m15:46:08.105690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c8e699070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c91bb2900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4c848225d0>]}
[0m15:46:08.107487 [debug] [MainThread]: Flushing usage events
[0m15:46:08.527208 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:10.564617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f388a39ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f386f6e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f386dc4aa0>]}


============================== 15:46:10.569230 | 1a347569-7b23-4099-bcc4-f9af0ab9b21a ==============================
[0m15:46:10.569230 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:46:10.570587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:46:10.744116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a347569-7b23-4099-bcc4-f9af0ab9b21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f386b4b4a0>]}
[0m15:46:10.784986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a347569-7b23-4099-bcc4-f9af0ab9b21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f3876cbe90>]}
[0m15:46:10.786169 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:46:10.827689 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:46:11.048821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:46:11.053879 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:46:11.078192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a347569-7b23-4099-bcc4-f9af0ab9b21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f385353770>]}
[0m15:46:11.191887 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:46:11.195691 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:46:11.224485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a347569-7b23-4099-bcc4-f9af0ab9b21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f384c69f70>]}
[0m15:46:11.225310 [info ] [MainThread]: Found 3 models, 4 data tests, 429 macros
[0m15:46:11.228556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a347569-7b23-4099-bcc4-f9af0ab9b21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f384c38800>]}
[0m15:46:11.231184 [info ] [MainThread]: 
[0m15:46:11.234600 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:46:11.236268 [info ] [MainThread]: 
[0m15:46:11.238372 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:46:11.247551 [debug] [ThreadPool]: Acquiring new postgres connection 'list_energyops_analytics'
[0m15:46:11.278065 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:46:11.281660 [debug] [ThreadPool]: On list_energyops_analytics: BEGIN
[0m15:46:11.282730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:11.288200 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m15:46:11.294471 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:46:11.296955 [debug] [ThreadPool]: On list_energyops_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "list_energyops_analytics"} */
select
      'energyops' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:46:11.299575 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m15:46:11.300965 [debug] [ThreadPool]: On list_energyops_analytics: ROLLBACK
[0m15:46:11.301790 [debug] [ThreadPool]: On list_energyops_analytics: Close
[0m15:46:11.305214 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:11.305834 [debug] [MainThread]: On master: BEGIN
[0m15:46:11.306449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:46:11.310089 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:46:11.310658 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:11.311215 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:46:11.313742 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m15:46:11.315004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a347569-7b23-4099-bcc4-f9af0ab9b21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f386b4b530>]}
[0m15:46:11.315655 [debug] [MainThread]: On master: ROLLBACK
[0m15:46:11.316227 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:11.316764 [debug] [MainThread]: On master: BEGIN
[0m15:46:11.317381 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:46:11.317897 [debug] [MainThread]: On master: COMMIT
[0m15:46:11.318354 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:11.318873 [debug] [MainThread]: On master: COMMIT
[0m15:46:11.319402 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:46:11.319948 [debug] [MainThread]: On master: Close
[0m15:46:11.321976 [debug] [Thread-1 (]: Began running node test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90
[0m15:46:11.322234 [debug] [Thread-2 (]: Began running node test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3
[0m15:46:11.322508 [debug] [Thread-3 (]: Began running node test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247
[0m15:46:11.322742 [debug] [Thread-4 (]: Began running node test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff
[0m15:46:11.323104 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_supplier_meter_readings_cadran .................. [RUN]
[0m15:46:11.323660 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_supplier_meter_readings_kwh ..................... [RUN]
[0m15:46:11.324440 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_supplier_meter_readings_period_end .............. [RUN]
[0m15:46:11.325070 [info ] [Thread-4 (]: 4 of 4 START test not_null_stg_supplier_meter_readings_period_start ............ [RUN]
[0m15:46:11.325712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_energyops_analytics, now test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90)
[0m15:46:11.326384 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3'
[0m15:46:11.327078 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247'
[0m15:46:11.327724 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff'
[0m15:46:11.328315 [debug] [Thread-1 (]: Began compiling node test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90
[0m15:46:11.328884 [debug] [Thread-2 (]: Began compiling node test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3
[0m15:46:11.329454 [debug] [Thread-3 (]: Began compiling node test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247
[0m15:46:11.329962 [debug] [Thread-4 (]: Began compiling node test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff
[0m15:46:11.340296 [debug] [Thread-1 (]: Writing injected SQL for node "test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90"
[0m15:46:11.343615 [debug] [Thread-2 (]: Writing injected SQL for node "test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3"
[0m15:46:11.346240 [debug] [Thread-3 (]: Writing injected SQL for node "test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247"
[0m15:46:11.348742 [debug] [Thread-4 (]: Writing injected SQL for node "test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff"
[0m15:46:11.353965 [debug] [Thread-1 (]: Began executing node test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90
[0m15:46:11.361173 [debug] [Thread-3 (]: Began executing node test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247
[0m15:46:11.365362 [debug] [Thread-1 (]: Writing runtime sql for node "test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90"
[0m15:46:11.367361 [debug] [Thread-3 (]: Writing runtime sql for node "test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247"
[0m15:46:11.367648 [debug] [Thread-4 (]: Began executing node test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff
[0m15:46:11.367891 [debug] [Thread-2 (]: Began executing node test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3
[0m15:46:11.370916 [debug] [Thread-4 (]: Writing runtime sql for node "test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff"
[0m15:46:11.372590 [debug] [Thread-2 (]: Writing runtime sql for node "test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3"
[0m15:46:11.376383 [debug] [Thread-1 (]: Using postgres connection "test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90"
[0m15:46:11.377341 [debug] [Thread-1 (]: On test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90: BEGIN
[0m15:46:11.377606 [debug] [Thread-3 (]: Using postgres connection "test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247"
[0m15:46:11.378245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:11.379254 [debug] [Thread-3 (]: On test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247: BEGIN
[0m15:46:11.379540 [debug] [Thread-4 (]: Using postgres connection "test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff"
[0m15:46:11.381579 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:46:11.383094 [debug] [Thread-4 (]: On test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff: BEGIN
[0m15:46:11.383419 [debug] [Thread-2 (]: Using postgres connection "test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3"
[0m15:46:11.383931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m15:46:11.387180 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:46:11.389208 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m15:46:11.390284 [debug] [Thread-2 (]: On test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3: BEGIN
[0m15:46:11.390937 [debug] [Thread-1 (]: Using postgres connection "test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90"
[0m15:46:11.391917 [debug] [Thread-3 (]: Using postgres connection "test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247"
[0m15:46:11.392946 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:46:11.393482 [debug] [Thread-1 (]: On test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cadran
from "energyops"."analytics"."stg_supplier_meter_readings"
where cadran is null



      
    ) dbt_internal_test
[0m15:46:11.394588 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m15:46:11.394862 [debug] [Thread-3 (]: On test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end
from "energyops"."analytics"."stg_supplier_meter_readings"
where period_end is null



      
    ) dbt_internal_test
[0m15:46:11.396232 [debug] [Thread-4 (]: Using postgres connection "test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff"
[0m15:46:11.397250 [debug] [Thread-4 (]: On test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_start
from "energyops"."analytics"."stg_supplier_meter_readings"
where period_start is null



      
    ) dbt_internal_test
[0m15:46:11.398384 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m15:46:11.398782 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:46:11.399017 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:46:11.399317 [debug] [Thread-2 (]: Using postgres connection "test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3"
[0m15:46:11.399686 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:46:11.402566 [debug] [Thread-4 (]: On test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff: ROLLBACK
[0m15:46:11.403798 [debug] [Thread-3 (]: On test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247: ROLLBACK
[0m15:46:11.404389 [debug] [Thread-2 (]: On test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select kwh
from "energyops"."analytics"."stg_supplier_meter_readings"
where kwh is null



      
    ) dbt_internal_test
[0m15:46:11.405513 [debug] [Thread-1 (]: On test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90: ROLLBACK
[0m15:46:11.406146 [debug] [Thread-4 (]: On test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff: Close
[0m15:46:11.406656 [debug] [Thread-3 (]: On test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247: Close
[0m15:46:11.407492 [debug] [Thread-1 (]: On test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90: Close
[0m15:46:11.407736 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:46:11.408251 [info ] [Thread-4 (]: 4 of 4 PASS not_null_stg_supplier_meter_readings_period_start .................. [[32mPASS[0m in 0.08s]
[0m15:46:11.409627 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_supplier_meter_readings_period_end .................... [[32mPASS[0m in 0.08s]
[0m15:46:11.410340 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_supplier_meter_readings_cadran ........................ [[32mPASS[0m in 0.08s]
[0m15:46:11.411528 [debug] [Thread-2 (]: On test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3: ROLLBACK
[0m15:46:11.412285 [debug] [Thread-4 (]: Finished running node test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff
[0m15:46:11.413023 [debug] [Thread-3 (]: Finished running node test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247
[0m15:46:11.413693 [debug] [Thread-1 (]: Finished running node test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90
[0m15:46:11.414369 [debug] [Thread-2 (]: On test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3: Close
[0m15:46:11.416217 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_supplier_meter_readings_kwh ........................... [[32mPASS[0m in 0.09s]
[0m15:46:11.416915 [debug] [Thread-2 (]: Finished running node test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3
[0m15:46:11.418893 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:11.419536 [debug] [MainThread]: On master: BEGIN
[0m15:46:11.420073 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:46:11.423948 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:46:11.424522 [debug] [MainThread]: On master: COMMIT
[0m15:46:11.425151 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:11.425721 [debug] [MainThread]: On master: COMMIT
[0m15:46:11.426425 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:46:11.426970 [debug] [MainThread]: On master: Close
[0m15:46:11.427602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:11.428120 [debug] [MainThread]: Connection 'test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90' was properly closed.
[0m15:46:11.428632 [debug] [MainThread]: Connection 'test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3' was properly closed.
[0m15:46:11.429138 [debug] [MainThread]: Connection 'test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247' was properly closed.
[0m15:46:11.429623 [debug] [MainThread]: Connection 'test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff' was properly closed.
[0m15:46:11.430116 [info ] [MainThread]: 
[0m15:46:11.430734 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m15:46:11.431869 [debug] [MainThread]: Command end result
[0m15:46:11.450356 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:46:11.453664 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:46:11.461015 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:46:11.461593 [info ] [MainThread]: 
[0m15:46:11.462534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:46:11.463913 [info ] [MainThread]: 
[0m15:46:11.464854 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:46:11.466860 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.94017744, "process_in_blocks": "1976", "process_kernel_time": 0.159344, "process_mem_max_rss": "110244", "process_out_blocks": "1608", "process_user_time": 1.239778}
[0m15:46:11.467807 [debug] [MainThread]: Command `dbt test` succeeded at 15:46:11.467706 after 0.94 seconds
[0m15:46:11.469554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f386c00530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f37ffc0710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f3871b8e60>]}
[0m15:46:11.471899 [debug] [MainThread]: Flushing usage events
[0m15:46:11.883800 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:21.493548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a5122e0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a5135b05c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a511be69c0>]}


============================== 15:47:21.498957 | 984a4f40-4303-4379-ab58-5933c144be32 ==============================
[0m15:47:21.498957 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:47:21.500577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:47:21.636602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '984a4f40-4303-4379-ab58-5933c144be32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a51157f5c0>]}
[0m15:47:21.676555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '984a4f40-4303-4379-ab58-5933c144be32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a5116ffb30>]}
[0m15:47:21.677632 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:47:21.774056 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:47:21.967388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:47:21.968605 [debug] [MainThread]: Partial parsing: updated file: energyops://models/marts/fct_energy_period.sql
[0m15:47:22.147393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '984a4f40-4303-4379-ab58-5933c144be32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a50f9d5a00>]}
[0m15:47:22.195444 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:47:22.198795 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:47:22.218132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '984a4f40-4303-4379-ab58-5933c144be32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a50fa8b290>]}
[0m15:47:22.218942 [info ] [MainThread]: Found 3 models, 4 data tests, 429 macros
[0m15:47:22.220307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '984a4f40-4303-4379-ab58-5933c144be32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a50faaad80>]}
[0m15:47:22.223184 [info ] [MainThread]: 
[0m15:47:22.224382 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:47:22.225436 [info ] [MainThread]: 
[0m15:47:22.229252 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:47:22.232559 [debug] [ThreadPool]: Acquiring new postgres connection 'list_energyops'
[0m15:47:22.253115 [debug] [ThreadPool]: Using postgres connection "list_energyops"
[0m15:47:22.253959 [debug] [ThreadPool]: On list_energyops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "list_energyops"} */

    select distinct nspname from pg_namespace
  
[0m15:47:22.254950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:22.261366 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m15:47:22.262708 [debug] [ThreadPool]: On list_energyops: Close
[0m15:47:22.264137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_energyops, now list_energyops_analytics)
[0m15:47:22.268052 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:47:22.268763 [debug] [ThreadPool]: On list_energyops_analytics: BEGIN
[0m15:47:22.269283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:22.273135 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:47:22.273737 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:47:22.274292 [debug] [ThreadPool]: On list_energyops_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "list_energyops_analytics"} */
select
      'energyops' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:47:22.276337 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m15:47:22.277400 [debug] [ThreadPool]: On list_energyops_analytics: ROLLBACK
[0m15:47:22.278148 [debug] [ThreadPool]: On list_energyops_analytics: Close
[0m15:47:22.281338 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:22.281854 [debug] [MainThread]: On master: BEGIN
[0m15:47:22.282303 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:22.286305 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:47:22.287054 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:22.287680 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:47:22.290177 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m15:47:22.291533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '984a4f40-4303-4379-ab58-5933c144be32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a51159b500>]}
[0m15:47:22.292196 [debug] [MainThread]: On master: ROLLBACK
[0m15:47:22.292819 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:22.293306 [debug] [MainThread]: On master: BEGIN
[0m15:47:22.293973 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:47:22.294553 [debug] [MainThread]: On master: COMMIT
[0m15:47:22.295107 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:22.295582 [debug] [MainThread]: On master: COMMIT
[0m15:47:22.296189 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:22.296683 [debug] [MainThread]: On master: Close
[0m15:47:22.299059 [debug] [Thread-1 (]: Began running node model.energyops.stg_supplier_meter_readings
[0m15:47:22.299781 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stg_supplier_meter_readings .............. [RUN]
[0m15:47:22.300450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_energyops_analytics, now model.energyops.stg_supplier_meter_readings)
[0m15:47:22.301134 [debug] [Thread-1 (]: Began compiling node model.energyops.stg_supplier_meter_readings
[0m15:47:22.306974 [debug] [Thread-1 (]: Writing injected SQL for node "model.energyops.stg_supplier_meter_readings"
[0m15:47:22.311663 [debug] [Thread-1 (]: Began executing node model.energyops.stg_supplier_meter_readings
[0m15:47:22.333831 [debug] [Thread-1 (]: Writing runtime sql for node "model.energyops.stg_supplier_meter_readings"
[0m15:47:22.351221 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:22.352003 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: BEGIN
[0m15:47:22.352726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:22.356536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:47:22.357140 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:22.357743 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */

  create view "energyops"."analytics"."stg_supplier_meter_readings__dbt_tmp"
    
    
  as (
    select
  period_start,
  period_end,
  trim(reading_type) as reading_type,
  upper(trim(cadran)) as cadran,
  index_start,
  index_end,
  kwh::numeric(12,3) as kwh,
  (period_end - period_start + 1) as period_days
from raw.supplier_meter_readings
  );
[0m15:47:22.359268 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:47:22.363348 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:22.363984 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
alter table "energyops"."analytics"."stg_supplier_meter_readings" rename to "stg_supplier_meter_readings__dbt_backup"
[0m15:47:22.364956 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:22.366914 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:22.367453 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
alter table "energyops"."analytics"."stg_supplier_meter_readings__dbt_tmp" rename to "stg_supplier_meter_readings"
[0m15:47:22.368164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:22.377930 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: COMMIT
[0m15:47:22.378547 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:22.379115 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: COMMIT
[0m15:47:22.383944 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:47:22.387702 [debug] [Thread-1 (]: Applying DROP to: "energyops"."analytics"."stg_supplier_meter_readings__dbt_backup"
[0m15:47:22.391506 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:22.392127 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
drop view if exists "energyops"."analytics"."stg_supplier_meter_readings__dbt_backup" cascade
[0m15:47:22.397201 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:47:22.399241 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: Close
[0m15:47:22.400787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '984a4f40-4303-4379-ab58-5933c144be32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a50c3cb0b0>]}
[0m15:47:22.401732 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stg_supplier_meter_readings ......... [[32mCREATE VIEW[0m in 0.10s]
[0m15:47:22.403303 [debug] [Thread-1 (]: Finished running node model.energyops.stg_supplier_meter_readings
[0m15:47:22.404375 [debug] [Thread-3 (]: Began running node model.energyops.fct_energy_period
[0m15:47:22.405088 [info ] [Thread-3 (]: 2 of 3 START sql table model analytics.fct_energy_period ....................... [RUN]
[0m15:47:22.405987 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.energyops.fct_energy_period'
[0m15:47:22.406526 [debug] [Thread-3 (]: Began compiling node model.energyops.fct_energy_period
[0m15:47:22.408985 [debug] [Thread-3 (]: Writing injected SQL for node "model.energyops.fct_energy_period"
[0m15:47:22.414350 [debug] [Thread-3 (]: Began executing node model.energyops.fct_energy_period
[0m15:47:22.428402 [debug] [Thread-3 (]: Writing runtime sql for node "model.energyops.fct_energy_period"
[0m15:47:22.437487 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:22.439747 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: BEGIN
[0m15:47:22.441241 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:47:22.446790 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m15:47:22.447529 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:22.448133 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */

  
    

  create  table "energyops"."analytics"."fct_energy_period__dbt_tmp"
  
  
    as
  
  (
    with base as (
  select
    period_start,
    period_end,
    max(period_days) as period_days,
    sum(kwh) filter (where cadran = 'HP') as kwh_hp,
    sum(kwh) filter (where cadran = 'HC') as kwh_hc
  from "energyops"."analytics"."stg_supplier_meter_readings"
  group by 1,2
),
tar as (
  select
    b.*,
    t.hp_eur_per_kwh,
    t.hc_eur_per_kwh
  from base b
  left join lateral (
    select hp_eur_per_kwh, hc_eur_per_kwh
    from config.tariff_hp_hc
    where effective_from <= b.period_end
    order by effective_from desc
    limit 1
  ) t on true
)
select
  period_start,
  period_end,
  period_days,
  coalesce(kwh_hp, 0) as kwh_hp,
  coalesce(kwh_hc, 0) as kwh_hc,
  (coalesce(kwh_hp,0) + coalesce(kwh_hc,0)) as kwh_total,
  ((coalesce(kwh_hp,0) + coalesce(kwh_hc,0)) / nullif(period_days,0))::numeric(12,3) as kwh_per_day_est,
  hp_eur_per_kwh,
  hc_eur_per_kwh,
  (coalesce(kwh_hp,0) * hp_eur_per_kwh + coalesce(kwh_hc,0) * hc_eur_per_kwh)::numeric(12,2) as cost_est_eur
from tar
order by period_end
  );
  
[0m15:47:22.462943 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.014 seconds
[0m15:47:22.465592 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:22.466842 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
alter table "energyops"."analytics"."fct_energy_period__dbt_tmp" rename to "fct_energy_period"
[0m15:47:22.468012 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:22.471483 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: COMMIT
[0m15:47:22.472883 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:22.473573 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: COMMIT
[0m15:47:22.476630 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:47:22.479043 [debug] [Thread-3 (]: Applying DROP to: "energyops"."analytics"."fct_energy_period__dbt_backup"
[0m15:47:22.481640 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:22.482310 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
drop table if exists "energyops"."analytics"."fct_energy_period__dbt_backup" cascade
[0m15:47:22.483301 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:47:22.484556 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: Close
[0m15:47:22.485432 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '984a4f40-4303-4379-ab58-5933c144be32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a50c2995e0>]}
[0m15:47:22.486650 [info ] [Thread-3 (]: 2 of 3 OK created sql table model analytics.fct_energy_period .................. [[32mSELECT 2[0m in 0.08s]
[0m15:47:22.488447 [debug] [Thread-3 (]: Finished running node model.energyops.fct_energy_period
[0m15:47:22.489427 [debug] [Thread-2 (]: Began running node model.energyops.agg_energy_calendar_month_est
[0m15:47:22.490300 [info ] [Thread-2 (]: 3 of 3 START sql table model analytics.agg_energy_calendar_month_est ........... [RUN]
[0m15:47:22.491475 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.energyops.agg_energy_calendar_month_est'
[0m15:47:22.492561 [debug] [Thread-2 (]: Began compiling node model.energyops.agg_energy_calendar_month_est
[0m15:47:22.494691 [debug] [Thread-2 (]: Writing injected SQL for node "model.energyops.agg_energy_calendar_month_est"
[0m15:47:22.500398 [debug] [Thread-2 (]: Began executing node model.energyops.agg_energy_calendar_month_est
[0m15:47:22.502690 [debug] [Thread-2 (]: Writing runtime sql for node "model.energyops.agg_energy_calendar_month_est"
[0m15:47:22.512233 [debug] [Thread-2 (]: Using postgres connection "model.energyops.agg_energy_calendar_month_est"
[0m15:47:22.512945 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: BEGIN
[0m15:47:22.513534 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:47:22.517669 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m15:47:22.518928 [debug] [Thread-2 (]: Using postgres connection "model.energyops.agg_energy_calendar_month_est"
[0m15:47:22.519585 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.agg_energy_calendar_month_est"} */

  
    

  create  table "energyops"."analytics"."agg_energy_calendar_month_est__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "energyops"."analytics"."fct_energy_period"
),
per_day as (
  select
    gs::date as day,
    (p.kwh_hp / nullif(p.period_days,0)) as kwh_hp,
    (p.kwh_hc / nullif(p.period_days,0)) as kwh_hc
  from p
  cross join lateral generate_series(p.period_start, p.period_end, interval '1 day') gs
)
select
  date_trunc('month', day)::date as month,
  sum(kwh_hp)::numeric(12,2) as kwh_hp_month,
  sum(kwh_hc)::numeric(12,2) as kwh_hc_month,
  sum(kwh_hp + kwh_hc)::numeric(12,2) as kwh_total_month
from per_day
group by 1
order by 1;
  );
  
[0m15:47:22.520434 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 30: order by 1;
                   ^

[0m15:47:22.521111 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: ROLLBACK
[0m15:47:22.521889 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: Close
[0m15:47:22.524206 [debug] [Thread-2 (]: Database Error in model agg_energy_calendar_month_est (models/marts/agg_energy_calendar_month_est.sql)
  syntax error at or near ";"
  LINE 30: order by 1;
                     ^
  compiled code at target/run/energyops/models/marts/agg_energy_calendar_month_est.sql
[0m15:47:22.524880 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '984a4f40-4303-4379-ab58-5933c144be32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a50c86d9a0>]}
[0m15:47:22.525683 [error] [Thread-2 (]: 3 of 3 ERROR creating sql table model analytics.agg_energy_calendar_month_est .. [[31mERROR[0m in 0.03s]
[0m15:47:22.526444 [debug] [Thread-2 (]: Finished running node model.energyops.agg_energy_calendar_month_est
[0m15:47:22.527146 [debug] [Thread-7 (]: Marking all children of 'model.energyops.agg_energy_calendar_month_est' to be skipped because of status 'error'.  Reason: Database Error in model agg_energy_calendar_month_est (models/marts/agg_energy_calendar_month_est.sql)
  syntax error at or near ";"
  LINE 30: order by 1;
                     ^
  compiled code at target/run/energyops/models/marts/agg_energy_calendar_month_est.sql.
[0m15:47:22.529046 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:22.529682 [debug] [MainThread]: On master: BEGIN
[0m15:47:22.530205 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:22.534156 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:47:22.534875 [debug] [MainThread]: On master: COMMIT
[0m15:47:22.535437 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:22.535981 [debug] [MainThread]: On master: COMMIT
[0m15:47:22.536599 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:22.537181 [debug] [MainThread]: On master: Close
[0m15:47:22.537848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:22.538360 [debug] [MainThread]: Connection 'model.energyops.stg_supplier_meter_readings' was properly closed.
[0m15:47:22.538892 [debug] [MainThread]: Connection 'model.energyops.fct_energy_period' was properly closed.
[0m15:47:22.539543 [debug] [MainThread]: Connection 'model.energyops.agg_energy_calendar_month_est' was properly closed.
[0m15:47:22.540217 [info ] [MainThread]: 
[0m15:47:22.540821 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m15:47:22.541852 [debug] [MainThread]: Command end result
[0m15:47:22.559878 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:47:22.563090 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:47:22.575963 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:47:22.579034 [info ] [MainThread]: 
[0m15:47:22.581070 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:47:22.582410 [info ] [MainThread]: 
[0m15:47:22.583709 [error] [MainThread]:   Database Error in model agg_energy_calendar_month_est (models/marts/agg_energy_calendar_month_est.sql)
  syntax error at or near ";"
  LINE 30: order by 1;
                     ^
  compiled code at target/run/energyops/models/marts/agg_energy_calendar_month_est.sql
[0m15:47:22.584826 [info ] [MainThread]: 
[0m15:47:22.585905 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:47:22.587844 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1325699, "process_in_blocks": "8", "process_kernel_time": 0.174372, "process_mem_max_rss": "112184", "process_out_blocks": "1608", "process_user_time": 1.47028}
[0m15:47:22.589137 [debug] [MainThread]: Command `dbt run` failed at 15:47:22.589042 after 1.13 seconds
[0m15:47:22.589948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a5120e8ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a51297b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a50fdb1b80>]}
[0m15:47:22.590878 [debug] [MainThread]: Flushing usage events
[0m15:47:22.997431 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:36.767985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edb20e1c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edb21542900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edb1f129a60>]}


============================== 15:47:36.773501 | 59440e41-c3f3-489f-bee2-7069b7afd761 ==============================
[0m15:47:36.773501 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:47:36.774336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:47:36.907038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59440e41-c3f3-489f-bee2-7069b7afd761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edb1ef1a0c0>]}
[0m15:47:36.949286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59440e41-c3f3-489f-bee2-7069b7afd761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edb1f125ac0>]}
[0m15:47:36.950299 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:47:36.992879 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:47:37.104542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:47:37.105486 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:47:37.130833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59440e41-c3f3-489f-bee2-7069b7afd761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edb1d5f8e60>]}
[0m15:47:37.184351 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:47:37.189161 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:47:37.211946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59440e41-c3f3-489f-bee2-7069b7afd761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edb1d39f050>]}
[0m15:47:37.214029 [info ] [MainThread]: Found 3 models, 4 data tests, 429 macros
[0m15:47:37.215041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59440e41-c3f3-489f-bee2-7069b7afd761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edb1d2ea480>]}
[0m15:47:37.217846 [info ] [MainThread]: 
[0m15:47:37.218939 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:47:37.219995 [info ] [MainThread]: 
[0m15:47:37.222233 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:47:37.226170 [debug] [ThreadPool]: Acquiring new postgres connection 'list_energyops'
[0m15:47:37.250677 [debug] [ThreadPool]: Using postgres connection "list_energyops"
[0m15:47:37.251605 [debug] [ThreadPool]: On list_energyops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "list_energyops"} */

    select distinct nspname from pg_namespace
  
[0m15:47:37.252244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:37.257561 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m15:47:37.258792 [debug] [ThreadPool]: On list_energyops: Close
[0m15:47:37.260150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_energyops, now list_energyops_analytics)
[0m15:47:37.263851 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:47:37.264385 [debug] [ThreadPool]: On list_energyops_analytics: BEGIN
[0m15:47:37.264834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:37.268626 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:47:37.269286 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:47:37.269851 [debug] [ThreadPool]: On list_energyops_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "list_energyops_analytics"} */
select
      'energyops' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:47:37.272165 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m15:47:37.273400 [debug] [ThreadPool]: On list_energyops_analytics: ROLLBACK
[0m15:47:37.274047 [debug] [ThreadPool]: On list_energyops_analytics: Close
[0m15:47:37.277532 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:37.278126 [debug] [MainThread]: On master: BEGIN
[0m15:47:37.278608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:37.282165 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:47:37.282664 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:37.283288 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:47:37.286322 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m15:47:37.287586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59440e41-c3f3-489f-bee2-7069b7afd761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edb1d41fef0>]}
[0m15:47:37.288244 [debug] [MainThread]: On master: ROLLBACK
[0m15:47:37.288844 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:37.289329 [debug] [MainThread]: On master: BEGIN
[0m15:47:37.290013 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:47:37.290555 [debug] [MainThread]: On master: COMMIT
[0m15:47:37.291056 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:37.291835 [debug] [MainThread]: On master: COMMIT
[0m15:47:37.292427 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:37.292996 [debug] [MainThread]: On master: Close
[0m15:47:37.295013 [debug] [Thread-1 (]: Began running node model.energyops.stg_supplier_meter_readings
[0m15:47:37.295720 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stg_supplier_meter_readings .............. [RUN]
[0m15:47:37.296466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_energyops_analytics, now model.energyops.stg_supplier_meter_readings)
[0m15:47:37.297066 [debug] [Thread-1 (]: Began compiling node model.energyops.stg_supplier_meter_readings
[0m15:47:37.301110 [debug] [Thread-1 (]: Writing injected SQL for node "model.energyops.stg_supplier_meter_readings"
[0m15:47:37.304667 [debug] [Thread-1 (]: Began executing node model.energyops.stg_supplier_meter_readings
[0m15:47:37.325699 [debug] [Thread-1 (]: Writing runtime sql for node "model.energyops.stg_supplier_meter_readings"
[0m15:47:37.330491 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:37.331446 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: BEGIN
[0m15:47:37.332015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:37.335825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:47:37.336640 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:37.337443 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */

  create view "energyops"."analytics"."stg_supplier_meter_readings__dbt_tmp"
    
    
  as (
    select
  period_start,
  period_end,
  trim(reading_type) as reading_type,
  upper(trim(cadran)) as cadran,
  index_start,
  index_end,
  kwh::numeric(12,3) as kwh,
  (period_end - period_start + 1) as period_days
from raw.supplier_meter_readings
  );
[0m15:47:37.339037 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:47:37.343067 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:37.343710 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
alter table "energyops"."analytics"."stg_supplier_meter_readings" rename to "stg_supplier_meter_readings__dbt_backup"
[0m15:47:37.344423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:37.346215 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:37.346798 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
alter table "energyops"."analytics"."stg_supplier_meter_readings__dbt_tmp" rename to "stg_supplier_meter_readings"
[0m15:47:37.347454 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:37.357646 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: COMMIT
[0m15:47:37.358294 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:37.358925 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: COMMIT
[0m15:47:37.363229 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:47:37.367239 [debug] [Thread-1 (]: Applying DROP to: "energyops"."analytics"."stg_supplier_meter_readings__dbt_backup"
[0m15:47:37.373634 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:37.374266 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
drop view if exists "energyops"."analytics"."stg_supplier_meter_readings__dbt_backup" cascade
[0m15:47:37.381358 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m15:47:37.383251 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: Close
[0m15:47:37.384987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59440e41-c3f3-489f-bee2-7069b7afd761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edb20d9e570>]}
[0m15:47:37.385933 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stg_supplier_meter_readings ......... [[32mCREATE VIEW[0m in 0.09s]
[0m15:47:37.386978 [debug] [Thread-1 (]: Finished running node model.energyops.stg_supplier_meter_readings
[0m15:47:37.388027 [debug] [Thread-3 (]: Began running node model.energyops.fct_energy_period
[0m15:47:37.388732 [info ] [Thread-3 (]: 2 of 3 START sql table model analytics.fct_energy_period ....................... [RUN]
[0m15:47:37.389568 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.energyops.fct_energy_period'
[0m15:47:37.390329 [debug] [Thread-3 (]: Began compiling node model.energyops.fct_energy_period
[0m15:47:37.393190 [debug] [Thread-3 (]: Writing injected SQL for node "model.energyops.fct_energy_period"
[0m15:47:37.397235 [debug] [Thread-3 (]: Began executing node model.energyops.fct_energy_period
[0m15:47:37.410950 [debug] [Thread-3 (]: Writing runtime sql for node "model.energyops.fct_energy_period"
[0m15:47:37.416994 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:37.417625 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: BEGIN
[0m15:47:37.418469 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:47:37.422418 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m15:47:37.423106 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:37.423677 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */

  
    

  create  table "energyops"."analytics"."fct_energy_period__dbt_tmp"
  
  
    as
  
  (
    with base as (
  select
    period_start,
    period_end,
    max(period_days) as period_days,
    sum(kwh) filter (where cadran = 'HP') as kwh_hp,
    sum(kwh) filter (where cadran = 'HC') as kwh_hc
  from "energyops"."analytics"."stg_supplier_meter_readings"
  group by 1,2
),
tar as (
  select
    b.*,
    t.hp_eur_per_kwh,
    t.hc_eur_per_kwh
  from base b
  left join lateral (
    select hp_eur_per_kwh, hc_eur_per_kwh
    from config.tariff_hp_hc
    where effective_from <= b.period_end
    order by effective_from desc
    limit 1
  ) t on true
)
select
  period_start,
  period_end,
  period_days,
  coalesce(kwh_hp, 0) as kwh_hp,
  coalesce(kwh_hc, 0) as kwh_hc,
  (coalesce(kwh_hp,0) + coalesce(kwh_hc,0)) as kwh_total,
  ((coalesce(kwh_hp,0) + coalesce(kwh_hc,0)) / nullif(period_days,0))::numeric(12,3) as kwh_per_day_est,
  hp_eur_per_kwh,
  hc_eur_per_kwh,
  (coalesce(kwh_hp,0) * hp_eur_per_kwh + coalesce(kwh_hc,0) * hc_eur_per_kwh)::numeric(12,2) as cost_est_eur
from tar
order by period_end
  );
  
[0m15:47:37.432971 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.009 seconds
[0m15:47:37.435182 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:37.435753 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
alter table "energyops"."analytics"."fct_energy_period" rename to "fct_energy_period__dbt_backup"
[0m15:47:37.436424 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:37.438152 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:37.438653 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
alter table "energyops"."analytics"."fct_energy_period__dbt_tmp" rename to "fct_energy_period"
[0m15:47:37.439385 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:37.442622 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: COMMIT
[0m15:47:37.443161 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:37.443669 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: COMMIT
[0m15:47:37.446599 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:47:37.448090 [debug] [Thread-3 (]: Applying DROP to: "energyops"."analytics"."fct_energy_period__dbt_backup"
[0m15:47:37.450338 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:37.450906 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
drop table if exists "energyops"."analytics"."fct_energy_period__dbt_backup" cascade
[0m15:47:37.454432 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:47:37.455554 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: Close
[0m15:47:37.456230 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59440e41-c3f3-489f-bee2-7069b7afd761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edb1c37b110>]}
[0m15:47:37.456933 [info ] [Thread-3 (]: 2 of 3 OK created sql table model analytics.fct_energy_period .................. [[32mSELECT 2[0m in 0.07s]
[0m15:47:37.457790 [debug] [Thread-3 (]: Finished running node model.energyops.fct_energy_period
[0m15:47:37.458787 [debug] [Thread-2 (]: Began running node model.energyops.agg_energy_calendar_month_est
[0m15:47:37.459480 [info ] [Thread-2 (]: 3 of 3 START sql table model analytics.agg_energy_calendar_month_est ........... [RUN]
[0m15:47:37.460904 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.energyops.agg_energy_calendar_month_est'
[0m15:47:37.461673 [debug] [Thread-2 (]: Began compiling node model.energyops.agg_energy_calendar_month_est
[0m15:47:37.463674 [debug] [Thread-2 (]: Writing injected SQL for node "model.energyops.agg_energy_calendar_month_est"
[0m15:47:37.467452 [debug] [Thread-2 (]: Began executing node model.energyops.agg_energy_calendar_month_est
[0m15:47:37.469487 [debug] [Thread-2 (]: Writing runtime sql for node "model.energyops.agg_energy_calendar_month_est"
[0m15:47:37.473392 [debug] [Thread-2 (]: Using postgres connection "model.energyops.agg_energy_calendar_month_est"
[0m15:47:37.474024 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: BEGIN
[0m15:47:37.474622 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:47:37.478523 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m15:47:37.479533 [debug] [Thread-2 (]: Using postgres connection "model.energyops.agg_energy_calendar_month_est"
[0m15:47:37.480165 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.agg_energy_calendar_month_est"} */

  
    

  create  table "energyops"."analytics"."agg_energy_calendar_month_est__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "energyops"."analytics"."fct_energy_period"
),
per_day as (
  select
    gs::date as day,
    (p.kwh_hp / nullif(p.period_days,0)) as kwh_hp,
    (p.kwh_hc / nullif(p.period_days,0)) as kwh_hc
  from p
  cross join lateral generate_series(p.period_start, p.period_end, interval '1 day') gs
)
select
  date_trunc('month', day)::date as month,
  sum(kwh_hp)::numeric(12,2) as kwh_hp_month,
  sum(kwh_hc)::numeric(12,2) as kwh_hc_month,
  sum(kwh_hp + kwh_hc)::numeric(12,2) as kwh_total_month
from per_day
group by 1
order by 1;
  );
  
[0m15:47:37.481041 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 30: order by 1;
                   ^

[0m15:47:37.482087 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: ROLLBACK
[0m15:47:37.483005 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: Close
[0m15:47:37.485311 [debug] [Thread-2 (]: Database Error in model agg_energy_calendar_month_est (models/marts/agg_energy_calendar_month_est.sql)
  syntax error at or near ";"
  LINE 30: order by 1;
                     ^
  compiled code at target/run/energyops/models/marts/agg_energy_calendar_month_est.sql
[0m15:47:37.485963 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59440e41-c3f3-489f-bee2-7069b7afd761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edb1ee1f200>]}
[0m15:47:37.486680 [error] [Thread-2 (]: 3 of 3 ERROR creating sql table model analytics.agg_energy_calendar_month_est .. [[31mERROR[0m in 0.03s]
[0m15:47:37.487517 [debug] [Thread-2 (]: Finished running node model.energyops.agg_energy_calendar_month_est
[0m15:47:37.488815 [debug] [Thread-7 (]: Marking all children of 'model.energyops.agg_energy_calendar_month_est' to be skipped because of status 'error'.  Reason: Database Error in model agg_energy_calendar_month_est (models/marts/agg_energy_calendar_month_est.sql)
  syntax error at or near ";"
  LINE 30: order by 1;
                     ^
  compiled code at target/run/energyops/models/marts/agg_energy_calendar_month_est.sql.
[0m15:47:37.491026 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:37.491723 [debug] [MainThread]: On master: BEGIN
[0m15:47:37.492334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:37.496212 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:47:37.496874 [debug] [MainThread]: On master: COMMIT
[0m15:47:37.497402 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:37.497960 [debug] [MainThread]: On master: COMMIT
[0m15:47:37.498561 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:37.499334 [debug] [MainThread]: On master: Close
[0m15:47:37.500219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:37.500843 [debug] [MainThread]: Connection 'model.energyops.stg_supplier_meter_readings' was properly closed.
[0m15:47:37.501358 [debug] [MainThread]: Connection 'model.energyops.fct_energy_period' was properly closed.
[0m15:47:37.502142 [debug] [MainThread]: Connection 'model.energyops.agg_energy_calendar_month_est' was properly closed.
[0m15:47:37.502977 [info ] [MainThread]: 
[0m15:47:37.503644 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m15:47:37.504838 [debug] [MainThread]: Command end result
[0m15:47:37.525917 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:47:37.529878 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:47:37.541819 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:47:37.542518 [info ] [MainThread]: 
[0m15:47:37.543486 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:47:37.545786 [info ] [MainThread]: 
[0m15:47:37.546715 [error] [MainThread]:   Database Error in model agg_energy_calendar_month_est (models/marts/agg_energy_calendar_month_est.sql)
  syntax error at or near ";"
  LINE 30: order by 1;
                     ^
  compiled code at target/run/energyops/models/marts/agg_energy_calendar_month_est.sql
[0m15:47:37.548172 [info ] [MainThread]: 
[0m15:47:37.550408 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:47:37.552824 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8624601, "process_in_blocks": "0", "process_kernel_time": 0.136446, "process_mem_max_rss": "109196", "process_out_blocks": "1608", "process_user_time": 1.332356}
[0m15:47:37.553631 [debug] [MainThread]: Command `dbt run` failed at 15:47:37.553541 after 0.86 seconds
[0m15:47:37.554295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edb1f129a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edb20d9e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edb1f241ca0>]}
[0m15:47:37.554974 [debug] [MainThread]: Flushing usage events
[0m15:47:37.949915 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:46.235535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d0be25b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d0bf3c0500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d0beaa2000>]}


============================== 15:47:46.241785 | 61b996a2-f490-4d05-bf9f-1532e6daab7c ==============================
[0m15:47:46.241785 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:47:46.242649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:47:46.377481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61b996a2-f490-4d05-bf9f-1532e6daab7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d0bdc0a4e0>]}
[0m15:47:46.418345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61b996a2-f490-4d05-bf9f-1532e6daab7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d0bf917fe0>]}
[0m15:47:46.419656 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:47:46.464469 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:47:46.585485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:47:46.586530 [debug] [MainThread]: Partial parsing: updated file: energyops://models/marts/agg_energy_calendar_month_est.sql
[0m15:47:46.759283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61b996a2-f490-4d05-bf9f-1532e6daab7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d0bbf2e000>]}
[0m15:47:46.807554 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:47:46.820300 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:47:46.839156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61b996a2-f490-4d05-bf9f-1532e6daab7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d0bc21f050>]}
[0m15:47:46.841200 [info ] [MainThread]: Found 3 models, 4 data tests, 429 macros
[0m15:47:46.843390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61b996a2-f490-4d05-bf9f-1532e6daab7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d0bc036480>]}
[0m15:47:46.847264 [info ] [MainThread]: 
[0m15:47:46.848315 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:47:46.849788 [info ] [MainThread]: 
[0m15:47:46.851150 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:47:46.854280 [debug] [ThreadPool]: Acquiring new postgres connection 'list_energyops'
[0m15:47:46.875512 [debug] [ThreadPool]: Using postgres connection "list_energyops"
[0m15:47:46.876370 [debug] [ThreadPool]: On list_energyops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "list_energyops"} */

    select distinct nspname from pg_namespace
  
[0m15:47:46.876984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:46.882535 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m15:47:46.883868 [debug] [ThreadPool]: On list_energyops: Close
[0m15:47:46.885308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_energyops, now list_energyops_analytics)
[0m15:47:46.889204 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:47:46.889883 [debug] [ThreadPool]: On list_energyops_analytics: BEGIN
[0m15:47:46.890474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:46.894354 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:47:46.895029 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:47:46.895555 [debug] [ThreadPool]: On list_energyops_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "list_energyops_analytics"} */
select
      'energyops' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:47:46.897748 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m15:47:46.898965 [debug] [ThreadPool]: On list_energyops_analytics: ROLLBACK
[0m15:47:46.899732 [debug] [ThreadPool]: On list_energyops_analytics: Close
[0m15:47:46.903083 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:46.903640 [debug] [MainThread]: On master: BEGIN
[0m15:47:46.904195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:46.907672 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:47:46.908295 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:46.908859 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:47:46.911939 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m15:47:46.913328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61b996a2-f490-4d05-bf9f-1532e6daab7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d0b819fc80>]}
[0m15:47:46.913999 [debug] [MainThread]: On master: ROLLBACK
[0m15:47:46.914606 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:46.915257 [debug] [MainThread]: On master: BEGIN
[0m15:47:46.915908 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:47:46.916414 [debug] [MainThread]: On master: COMMIT
[0m15:47:46.916878 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:46.917459 [debug] [MainThread]: On master: COMMIT
[0m15:47:46.918023 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:46.918604 [debug] [MainThread]: On master: Close
[0m15:47:46.920850 [debug] [Thread-1 (]: Began running node model.energyops.stg_supplier_meter_readings
[0m15:47:46.921602 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stg_supplier_meter_readings .............. [RUN]
[0m15:47:46.922276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_energyops_analytics, now model.energyops.stg_supplier_meter_readings)
[0m15:47:46.922867 [debug] [Thread-1 (]: Began compiling node model.energyops.stg_supplier_meter_readings
[0m15:47:46.927704 [debug] [Thread-1 (]: Writing injected SQL for node "model.energyops.stg_supplier_meter_readings"
[0m15:47:46.931936 [debug] [Thread-1 (]: Began executing node model.energyops.stg_supplier_meter_readings
[0m15:47:46.953431 [debug] [Thread-1 (]: Writing runtime sql for node "model.energyops.stg_supplier_meter_readings"
[0m15:47:46.959319 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:46.959985 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: BEGIN
[0m15:47:46.960598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:46.964279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:47:46.964903 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:46.965541 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */

  create view "energyops"."analytics"."stg_supplier_meter_readings__dbt_tmp"
    
    
  as (
    select
  period_start,
  period_end,
  trim(reading_type) as reading_type,
  upper(trim(cadran)) as cadran,
  index_start,
  index_end,
  kwh::numeric(12,3) as kwh,
  (period_end - period_start + 1) as period_days
from raw.supplier_meter_readings
  );
[0m15:47:46.966915 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:47:46.970826 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:46.971533 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
alter table "energyops"."analytics"."stg_supplier_meter_readings" rename to "stg_supplier_meter_readings__dbt_backup"
[0m15:47:46.972275 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:46.974237 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:46.974889 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
alter table "energyops"."analytics"."stg_supplier_meter_readings__dbt_tmp" rename to "stg_supplier_meter_readings"
[0m15:47:46.975626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:46.985584 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: COMMIT
[0m15:47:46.986163 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:46.987035 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: COMMIT
[0m15:47:47.004436 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:47:47.040014 [debug] [Thread-1 (]: Applying DROP to: "energyops"."analytics"."stg_supplier_meter_readings__dbt_backup"
[0m15:47:47.052804 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:47:47.071832 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
drop view if exists "energyops"."analytics"."stg_supplier_meter_readings__dbt_backup" cascade
[0m15:47:47.078898 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:47:47.082649 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: Close
[0m15:47:47.085717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b996a2-f490-4d05-bf9f-1532e6daab7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d0bfa8e5a0>]}
[0m15:47:47.089375 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stg_supplier_meter_readings ......... [[32mCREATE VIEW[0m in 0.16s]
[0m15:47:47.092910 [debug] [Thread-1 (]: Finished running node model.energyops.stg_supplier_meter_readings
[0m15:47:47.094589 [debug] [Thread-3 (]: Began running node model.energyops.fct_energy_period
[0m15:47:47.097734 [info ] [Thread-3 (]: 2 of 3 START sql table model analytics.fct_energy_period ....................... [RUN]
[0m15:47:47.101759 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.energyops.fct_energy_period'
[0m15:47:47.106241 [debug] [Thread-3 (]: Began compiling node model.energyops.fct_energy_period
[0m15:47:47.110169 [debug] [Thread-3 (]: Writing injected SQL for node "model.energyops.fct_energy_period"
[0m15:47:47.139401 [debug] [Thread-3 (]: Began executing node model.energyops.fct_energy_period
[0m15:47:47.155008 [debug] [Thread-3 (]: Writing runtime sql for node "model.energyops.fct_energy_period"
[0m15:47:47.185437 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:47.192467 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: BEGIN
[0m15:47:47.197133 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:47:47.201501 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m15:47:47.202631 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:47.203376 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */

  
    

  create  table "energyops"."analytics"."fct_energy_period__dbt_tmp"
  
  
    as
  
  (
    with base as (
  select
    period_start,
    period_end,
    max(period_days) as period_days,
    sum(kwh) filter (where cadran = 'HP') as kwh_hp,
    sum(kwh) filter (where cadran = 'HC') as kwh_hc
  from "energyops"."analytics"."stg_supplier_meter_readings"
  group by 1,2
),
tar as (
  select
    b.*,
    t.hp_eur_per_kwh,
    t.hc_eur_per_kwh
  from base b
  left join lateral (
    select hp_eur_per_kwh, hc_eur_per_kwh
    from config.tariff_hp_hc
    where effective_from <= b.period_end
    order by effective_from desc
    limit 1
  ) t on true
)
select
  period_start,
  period_end,
  period_days,
  coalesce(kwh_hp, 0) as kwh_hp,
  coalesce(kwh_hc, 0) as kwh_hc,
  (coalesce(kwh_hp,0) + coalesce(kwh_hc,0)) as kwh_total,
  ((coalesce(kwh_hp,0) + coalesce(kwh_hc,0)) / nullif(period_days,0))::numeric(12,3) as kwh_per_day_est,
  hp_eur_per_kwh,
  hc_eur_per_kwh,
  (coalesce(kwh_hp,0) * hp_eur_per_kwh + coalesce(kwh_hc,0) * hc_eur_per_kwh)::numeric(12,2) as cost_est_eur
from tar
order by period_end
  );
  
[0m15:47:47.213965 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.008 seconds
[0m15:47:47.216999 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:47.217954 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
alter table "energyops"."analytics"."fct_energy_period" rename to "fct_energy_period__dbt_backup"
[0m15:47:47.219435 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:47.223211 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:47.224005 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
alter table "energyops"."analytics"."fct_energy_period__dbt_tmp" rename to "fct_energy_period"
[0m15:47:47.224861 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:47:47.228259 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: COMMIT
[0m15:47:47.228839 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:47.229393 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: COMMIT
[0m15:47:47.232295 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:47:47.233866 [debug] [Thread-3 (]: Applying DROP to: "energyops"."analytics"."fct_energy_period__dbt_backup"
[0m15:47:47.236110 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:47:47.236728 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
drop table if exists "energyops"."analytics"."fct_energy_period__dbt_backup" cascade
[0m15:47:47.240374 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:47:47.241634 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: Close
[0m15:47:47.242413 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b996a2-f490-4d05-bf9f-1532e6daab7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d053f6cd70>]}
[0m15:47:47.243184 [info ] [Thread-3 (]: 2 of 3 OK created sql table model analytics.fct_energy_period .................. [[32mSELECT 2[0m in 0.14s]
[0m15:47:47.244417 [debug] [Thread-3 (]: Finished running node model.energyops.fct_energy_period
[0m15:47:47.245410 [debug] [Thread-2 (]: Began running node model.energyops.agg_energy_calendar_month_est
[0m15:47:47.246265 [info ] [Thread-2 (]: 3 of 3 START sql table model analytics.agg_energy_calendar_month_est ........... [RUN]
[0m15:47:47.247018 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.energyops.agg_energy_calendar_month_est'
[0m15:47:47.247603 [debug] [Thread-2 (]: Began compiling node model.energyops.agg_energy_calendar_month_est
[0m15:47:47.249482 [debug] [Thread-2 (]: Writing injected SQL for node "model.energyops.agg_energy_calendar_month_est"
[0m15:47:47.253560 [debug] [Thread-2 (]: Began executing node model.energyops.agg_energy_calendar_month_est
[0m15:47:47.255870 [debug] [Thread-2 (]: Writing runtime sql for node "model.energyops.agg_energy_calendar_month_est"
[0m15:47:47.260591 [debug] [Thread-2 (]: Using postgres connection "model.energyops.agg_energy_calendar_month_est"
[0m15:47:47.262484 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: BEGIN
[0m15:47:47.264842 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:47:47.269685 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m15:47:47.270474 [debug] [Thread-2 (]: Using postgres connection "model.energyops.agg_energy_calendar_month_est"
[0m15:47:47.271139 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.agg_energy_calendar_month_est"} */

  
    

  create  table "energyops"."analytics"."agg_energy_calendar_month_est__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "energyops"."analytics"."fct_energy_period"
),
per_day as (
  select
    gs::date as day,
    (p.kwh_hp / nullif(p.period_days,0)) as kwh_hp,
    (p.kwh_hc / nullif(p.period_days,0)) as kwh_hc
  from p
  cross join lateral generate_series(p.period_start, p.period_end, interval '1 day') gs
)
select
  date_trunc('month', day)::date as month,
  sum(kwh_hp)::numeric(12,2) as kwh_hp_month,
  sum(kwh_hc)::numeric(12,2) as kwh_hc_month,
  sum(kwh_hp + kwh_hc)::numeric(12,2) as kwh_total_month
group by 1
order by 1
  );
  
[0m15:47:47.273284 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "day" does not exist
LINE 24:   date_trunc('month', day)::date as month,
                               ^

[0m15:47:47.273951 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: ROLLBACK
[0m15:47:47.274840 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: Close
[0m15:47:47.277199 [debug] [Thread-2 (]: Database Error in model agg_energy_calendar_month_est (models/marts/agg_energy_calendar_month_est.sql)
  column "day" does not exist
  LINE 24:   date_trunc('month', day)::date as month,
                                 ^
  compiled code at target/run/energyops/models/marts/agg_energy_calendar_month_est.sql
[0m15:47:47.278018 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b996a2-f490-4d05-bf9f-1532e6daab7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d053f150a0>]}
[0m15:47:47.278803 [error] [Thread-2 (]: 3 of 3 ERROR creating sql table model analytics.agg_energy_calendar_month_est .. [[31mERROR[0m in 0.03s]
[0m15:47:47.279520 [debug] [Thread-2 (]: Finished running node model.energyops.agg_energy_calendar_month_est
[0m15:47:47.280372 [debug] [Thread-7 (]: Marking all children of 'model.energyops.agg_energy_calendar_month_est' to be skipped because of status 'error'.  Reason: Database Error in model agg_energy_calendar_month_est (models/marts/agg_energy_calendar_month_est.sql)
  column "day" does not exist
  LINE 24:   date_trunc('month', day)::date as month,
                                 ^
  compiled code at target/run/energyops/models/marts/agg_energy_calendar_month_est.sql.
[0m15:47:47.282294 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:47.282895 [debug] [MainThread]: On master: BEGIN
[0m15:47:47.283410 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:47.287181 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:47:47.287879 [debug] [MainThread]: On master: COMMIT
[0m15:47:47.288615 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:47.289136 [debug] [MainThread]: On master: COMMIT
[0m15:47:47.290046 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:47.290618 [debug] [MainThread]: On master: Close
[0m15:47:47.291294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:47.291823 [debug] [MainThread]: Connection 'model.energyops.stg_supplier_meter_readings' was properly closed.
[0m15:47:47.292274 [debug] [MainThread]: Connection 'model.energyops.fct_energy_period' was properly closed.
[0m15:47:47.292686 [debug] [MainThread]: Connection 'model.energyops.agg_energy_calendar_month_est' was properly closed.
[0m15:47:47.293258 [info ] [MainThread]: 
[0m15:47:47.293826 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m15:47:47.295007 [debug] [MainThread]: Command end result
[0m15:47:47.313392 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:47:47.317622 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:47:47.323692 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:47:47.324297 [info ] [MainThread]: 
[0m15:47:47.324986 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:47:47.325695 [info ] [MainThread]: 
[0m15:47:47.326542 [error] [MainThread]:   Database Error in model agg_energy_calendar_month_est (models/marts/agg_energy_calendar_month_est.sql)
  column "day" does not exist
  LINE 24:   date_trunc('month', day)::date as month,
                                 ^
  compiled code at target/run/energyops/models/marts/agg_energy_calendar_month_est.sql
[0m15:47:47.327439 [info ] [MainThread]: 
[0m15:47:47.328797 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:47:47.330241 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1397693, "process_in_blocks": "0", "process_kernel_time": 0.139727, "process_mem_max_rss": "112244", "process_out_blocks": "1608", "process_user_time": 1.461153}
[0m15:47:47.331207 [debug] [MainThread]: Command `dbt run` failed at 15:47:47.331121 after 1.14 seconds
[0m15:47:47.332045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d0be737800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d0bf4df590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d0be68be30>]}
[0m15:47:47.333220 [debug] [MainThread]: Flushing usage events
[0m15:47:47.757389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:05.535785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75413c8660f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75413c5ce840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75413cf60bf0>]}


============================== 15:48:05.545556 | f51323f3-5eb9-4c17-8e20-180f8f4bb0e0 ==============================
[0m15:48:05.545556 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:48:05.549119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:05.705051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f51323f3-5eb9-4c17-8e20-180f8f4bb0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75413c7fe390>]}
[0m15:48:05.749792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f51323f3-5eb9-4c17-8e20-180f8f4bb0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75413a9aaa80>]}
[0m15:48:05.751584 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:48:05.794989 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:48:06.198414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:48:06.199696 [debug] [MainThread]: Partial parsing: updated file: energyops://models/marts/agg_energy_calendar_month_est.sql
[0m15:48:06.392154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f51323f3-5eb9-4c17-8e20-180f8f4bb0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75413a661dc0>]}
[0m15:48:06.448149 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:48:06.452927 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:48:06.473636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f51323f3-5eb9-4c17-8e20-180f8f4bb0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75413a7b1eb0>]}
[0m15:48:06.475252 [info ] [MainThread]: Found 3 models, 4 data tests, 429 macros
[0m15:48:06.476381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f51323f3-5eb9-4c17-8e20-180f8f4bb0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75413a7b13d0>]}
[0m15:48:06.478860 [info ] [MainThread]: 
[0m15:48:06.479782 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:48:06.480940 [info ] [MainThread]: 
[0m15:48:06.482344 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:48:06.486130 [debug] [ThreadPool]: Acquiring new postgres connection 'list_energyops'
[0m15:48:06.507352 [debug] [ThreadPool]: Using postgres connection "list_energyops"
[0m15:48:06.508469 [debug] [ThreadPool]: On list_energyops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "list_energyops"} */

    select distinct nspname from pg_namespace
  
[0m15:48:06.509465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:06.515810 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m15:48:06.517828 [debug] [ThreadPool]: On list_energyops: Close
[0m15:48:06.519941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_energyops, now list_energyops_analytics)
[0m15:48:06.524780 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:48:06.525848 [debug] [ThreadPool]: On list_energyops_analytics: BEGIN
[0m15:48:06.526794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:06.531326 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.532397 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:48:06.533487 [debug] [ThreadPool]: On list_energyops_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "list_energyops_analytics"} */
select
      'energyops' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:48:06.536558 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m15:48:06.543183 [debug] [ThreadPool]: On list_energyops_analytics: ROLLBACK
[0m15:48:06.569327 [debug] [ThreadPool]: On list_energyops_analytics: Close
[0m15:48:06.577120 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:06.578667 [debug] [MainThread]: On master: BEGIN
[0m15:48:06.581153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:06.586815 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:48:06.588159 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:06.589329 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:48:06.593303 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m15:48:06.595127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f51323f3-5eb9-4c17-8e20-180f8f4bb0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75413c26a480>]}
[0m15:48:06.596220 [debug] [MainThread]: On master: ROLLBACK
[0m15:48:06.597525 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:06.598863 [debug] [MainThread]: On master: BEGIN
[0m15:48:06.600434 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:48:06.601571 [debug] [MainThread]: On master: COMMIT
[0m15:48:06.602480 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:06.603284 [debug] [MainThread]: On master: COMMIT
[0m15:48:06.604257 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:48:06.605060 [debug] [MainThread]: On master: Close
[0m15:48:06.607551 [debug] [Thread-1 (]: Began running node model.energyops.stg_supplier_meter_readings
[0m15:48:06.608564 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stg_supplier_meter_readings .............. [RUN]
[0m15:48:06.609523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_energyops_analytics, now model.energyops.stg_supplier_meter_readings)
[0m15:48:06.610300 [debug] [Thread-1 (]: Began compiling node model.energyops.stg_supplier_meter_readings
[0m15:48:06.615383 [debug] [Thread-1 (]: Writing injected SQL for node "model.energyops.stg_supplier_meter_readings"
[0m15:48:06.622535 [debug] [Thread-1 (]: Began executing node model.energyops.stg_supplier_meter_readings
[0m15:48:06.643639 [debug] [Thread-1 (]: Writing runtime sql for node "model.energyops.stg_supplier_meter_readings"
[0m15:48:06.653676 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:48:06.654683 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: BEGIN
[0m15:48:06.655662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:06.660000 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.661195 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:48:06.662162 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */

  create view "energyops"."analytics"."stg_supplier_meter_readings__dbt_tmp"
    
    
  as (
    select
  period_start,
  period_end,
  trim(reading_type) as reading_type,
  upper(trim(cadran)) as cadran,
  index_start,
  index_end,
  kwh::numeric(12,3) as kwh,
  (period_end - period_start + 1) as period_days
from raw.supplier_meter_readings
  );
[0m15:48:06.664058 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:48:06.668664 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:48:06.669745 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
alter table "energyops"."analytics"."stg_supplier_meter_readings" rename to "stg_supplier_meter_readings__dbt_backup"
[0m15:48:06.670860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:06.673056 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:48:06.674194 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
alter table "energyops"."analytics"."stg_supplier_meter_readings__dbt_tmp" rename to "stg_supplier_meter_readings"
[0m15:48:06.675201 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:06.685193 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: COMMIT
[0m15:48:06.685949 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:48:06.686536 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: COMMIT
[0m15:48:06.691109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:48:06.695206 [debug] [Thread-1 (]: Applying DROP to: "energyops"."analytics"."stg_supplier_meter_readings__dbt_backup"
[0m15:48:06.699151 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:48:06.699878 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
drop view if exists "energyops"."analytics"."stg_supplier_meter_readings__dbt_backup" cascade
[0m15:48:06.703407 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:48:06.705503 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: Close
[0m15:48:06.707053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f51323f3-5eb9-4c17-8e20-180f8f4bb0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75413e1b6540>]}
[0m15:48:06.707801 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stg_supplier_meter_readings ......... [[32mCREATE VIEW[0m in 0.10s]
[0m15:48:06.708570 [debug] [Thread-1 (]: Finished running node model.energyops.stg_supplier_meter_readings
[0m15:48:06.709600 [debug] [Thread-3 (]: Began running node model.energyops.fct_energy_period
[0m15:48:06.710256 [info ] [Thread-3 (]: 2 of 3 START sql table model analytics.fct_energy_period ....................... [RUN]
[0m15:48:06.711164 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.energyops.fct_energy_period'
[0m15:48:06.711836 [debug] [Thread-3 (]: Began compiling node model.energyops.fct_energy_period
[0m15:48:06.713935 [debug] [Thread-3 (]: Writing injected SQL for node "model.energyops.fct_energy_period"
[0m15:48:06.718220 [debug] [Thread-3 (]: Began executing node model.energyops.fct_energy_period
[0m15:48:06.730900 [debug] [Thread-3 (]: Writing runtime sql for node "model.energyops.fct_energy_period"
[0m15:48:06.736033 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:48:06.736693 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: BEGIN
[0m15:48:06.737304 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:48:06.741630 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.742496 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:48:06.743211 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */

  
    

  create  table "energyops"."analytics"."fct_energy_period__dbt_tmp"
  
  
    as
  
  (
    with base as (
  select
    period_start,
    period_end,
    max(period_days) as period_days,
    sum(kwh) filter (where cadran = 'HP') as kwh_hp,
    sum(kwh) filter (where cadran = 'HC') as kwh_hc
  from "energyops"."analytics"."stg_supplier_meter_readings"
  group by 1,2
),
tar as (
  select
    b.*,
    t.hp_eur_per_kwh,
    t.hc_eur_per_kwh
  from base b
  left join lateral (
    select hp_eur_per_kwh, hc_eur_per_kwh
    from config.tariff_hp_hc
    where effective_from <= b.period_end
    order by effective_from desc
    limit 1
  ) t on true
)
select
  period_start,
  period_end,
  period_days,
  coalesce(kwh_hp, 0) as kwh_hp,
  coalesce(kwh_hc, 0) as kwh_hc,
  (coalesce(kwh_hp,0) + coalesce(kwh_hc,0)) as kwh_total,
  ((coalesce(kwh_hp,0) + coalesce(kwh_hc,0)) / nullif(period_days,0))::numeric(12,3) as kwh_per_day_est,
  hp_eur_per_kwh,
  hc_eur_per_kwh,
  (coalesce(kwh_hp,0) * hp_eur_per_kwh + coalesce(kwh_hc,0) * hc_eur_per_kwh)::numeric(12,2) as cost_est_eur
from tar
order by period_end
  );
  
[0m15:48:06.751788 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.008 seconds
[0m15:48:06.754275 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:48:06.754895 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
alter table "energyops"."analytics"."fct_energy_period" rename to "fct_energy_period__dbt_backup"
[0m15:48:06.755667 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:06.758222 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:48:06.758825 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
alter table "energyops"."analytics"."fct_energy_period__dbt_tmp" rename to "fct_energy_period"
[0m15:48:06.759681 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:06.762910 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: COMMIT
[0m15:48:06.763441 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:48:06.763968 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: COMMIT
[0m15:48:06.767209 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m15:48:06.768894 [debug] [Thread-3 (]: Applying DROP to: "energyops"."analytics"."fct_energy_period__dbt_backup"
[0m15:48:06.771099 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:48:06.771741 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
drop table if exists "energyops"."analytics"."fct_energy_period__dbt_backup" cascade
[0m15:48:06.775124 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:48:06.776353 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: Close
[0m15:48:06.777067 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f51323f3-5eb9-4c17-8e20-180f8f4bb0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7540f26cd010>]}
[0m15:48:06.777919 [info ] [Thread-3 (]: 2 of 3 OK created sql table model analytics.fct_energy_period .................. [[32mSELECT 2[0m in 0.07s]
[0m15:48:06.779161 [debug] [Thread-3 (]: Finished running node model.energyops.fct_energy_period
[0m15:48:06.780398 [debug] [Thread-2 (]: Began running node model.energyops.agg_energy_calendar_month_est
[0m15:48:06.781520 [info ] [Thread-2 (]: 3 of 3 START sql table model analytics.agg_energy_calendar_month_est ........... [RUN]
[0m15:48:06.783788 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.energyops.agg_energy_calendar_month_est'
[0m15:48:06.784733 [debug] [Thread-2 (]: Began compiling node model.energyops.agg_energy_calendar_month_est
[0m15:48:06.787180 [debug] [Thread-2 (]: Writing injected SQL for node "model.energyops.agg_energy_calendar_month_est"
[0m15:48:06.794864 [debug] [Thread-2 (]: Began executing node model.energyops.agg_energy_calendar_month_est
[0m15:48:06.797588 [debug] [Thread-2 (]: Writing runtime sql for node "model.energyops.agg_energy_calendar_month_est"
[0m15:48:06.805385 [debug] [Thread-2 (]: Using postgres connection "model.energyops.agg_energy_calendar_month_est"
[0m15:48:06.807069 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: BEGIN
[0m15:48:06.808374 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:48:06.812650 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m15:48:06.814097 [debug] [Thread-2 (]: Using postgres connection "model.energyops.agg_energy_calendar_month_est"
[0m15:48:06.815244 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.agg_energy_calendar_month_est"} */

  
    

  create  table "energyops"."analytics"."agg_energy_calendar_month_est__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "energyops"."analytics"."fct_energy_period"
),
per_day as (
  select
    gs::date as day,
    (p.kwh_hp / nullif(p.period_days,0)) as kwh_hp,
    (p.kwh_hc / nullif(p.period_days,0)) as kwh_hc
  from p
  cross join lateral generate_series(p.period_start, p.period_end, interval '1 day') gs
)
select
  date_trunc('month', day)::date as month,
  sum(kwh_hp)::numeric(12,2) as kwh_hp_month,
  sum(kwh_hc)::numeric(12,2) as kwh_hc_month,
  sum(kwh_hp + kwh_hc)::numeric(12,2) as kwh_total_month
group by 1
order by 1;
  );
  
[0m15:48:06.816310 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 29: order by 1;
                   ^

[0m15:48:06.817009 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: ROLLBACK
[0m15:48:06.817820 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: Close
[0m15:48:06.820429 [debug] [Thread-2 (]: Database Error in model agg_energy_calendar_month_est (models/marts/agg_energy_calendar_month_est.sql)
  syntax error at or near ";"
  LINE 29: order by 1;
                     ^
  compiled code at target/run/energyops/models/marts/agg_energy_calendar_month_est.sql
[0m15:48:06.821617 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f51323f3-5eb9-4c17-8e20-180f8f4bb0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75413808fd10>]}
[0m15:48:06.822701 [error] [Thread-2 (]: 3 of 3 ERROR creating sql table model analytics.agg_energy_calendar_month_est .. [[31mERROR[0m in 0.04s]
[0m15:48:06.823709 [debug] [Thread-2 (]: Finished running node model.energyops.agg_energy_calendar_month_est
[0m15:48:06.824753 [debug] [Thread-7 (]: Marking all children of 'model.energyops.agg_energy_calendar_month_est' to be skipped because of status 'error'.  Reason: Database Error in model agg_energy_calendar_month_est (models/marts/agg_energy_calendar_month_est.sql)
  syntax error at or near ";"
  LINE 29: order by 1;
                     ^
  compiled code at target/run/energyops/models/marts/agg_energy_calendar_month_est.sql.
[0m15:48:06.826946 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:06.827605 [debug] [MainThread]: On master: BEGIN
[0m15:48:06.833474 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:48:06.848390 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m15:48:06.850022 [debug] [MainThread]: On master: COMMIT
[0m15:48:06.850990 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:06.856394 [debug] [MainThread]: On master: COMMIT
[0m15:48:06.864191 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:48:06.865914 [debug] [MainThread]: On master: Close
[0m15:48:06.873092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:06.876474 [debug] [MainThread]: Connection 'model.energyops.stg_supplier_meter_readings' was properly closed.
[0m15:48:06.877420 [debug] [MainThread]: Connection 'model.energyops.fct_energy_period' was properly closed.
[0m15:48:06.878284 [debug] [MainThread]: Connection 'model.energyops.agg_energy_calendar_month_est' was properly closed.
[0m15:48:06.879492 [info ] [MainThread]: 
[0m15:48:06.881133 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m15:48:06.882687 [debug] [MainThread]: Command end result
[0m15:48:06.904439 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:48:06.911040 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:48:06.921391 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:48:06.922121 [info ] [MainThread]: 
[0m15:48:06.922842 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:48:06.926043 [info ] [MainThread]: 
[0m15:48:06.927181 [error] [MainThread]:   Database Error in model agg_energy_calendar_month_est (models/marts/agg_energy_calendar_month_est.sql)
  syntax error at or near ";"
  LINE 29: order by 1;
                     ^
  compiled code at target/run/energyops/models/marts/agg_energy_calendar_month_est.sql
[0m15:48:06.928965 [info ] [MainThread]: 
[0m15:48:06.931030 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:48:06.933198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4898075, "process_in_blocks": "0", "process_kernel_time": 0.186411, "process_mem_max_rss": "112364", "process_out_blocks": "1608", "process_user_time": 1.50319}
[0m15:48:06.934060 [debug] [MainThread]: Command `dbt run` failed at 15:48:06.933959 after 1.49 seconds
[0m15:48:06.934719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75413c88e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75413c297ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75413a7202c0>]}
[0m15:48:06.935334 [debug] [MainThread]: Flushing usage events
[0m15:48:07.311874 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:49:16.117818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d234e0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d23a198b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d23810ce0>]}


============================== 15:49:16.124009 | 5809bb6e-88fa-4ff4-a5e4-4d88aa6dcdf4 ==============================
[0m15:49:16.124009 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:49:16.125403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:49:16.271223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5809bb6e-88fa-4ff4-a5e4-4d88aa6dcdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d22f13d10>]}
[0m15:49:16.310122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5809bb6e-88fa-4ff4-a5e4-4d88aa6dcdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d215f40e0>]}
[0m15:49:16.311419 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:49:16.353875 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:49:16.466863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:49:16.467693 [debug] [MainThread]: Partial parsing: updated file: energyops://models/marts/agg_energy_calendar_month_est.sql
[0m15:49:16.646954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5809bb6e-88fa-4ff4-a5e4-4d88aa6dcdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d2138f4d0>]}
[0m15:49:16.699893 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:49:16.705693 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:49:16.724321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5809bb6e-88fa-4ff4-a5e4-4d88aa6dcdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d2142ed20>]}
[0m15:49:16.725363 [info ] [MainThread]: Found 3 models, 4 data tests, 429 macros
[0m15:49:16.730641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5809bb6e-88fa-4ff4-a5e4-4d88aa6dcdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d21472570>]}
[0m15:49:16.733975 [info ] [MainThread]: 
[0m15:49:16.738334 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:49:16.739620 [info ] [MainThread]: 
[0m15:49:16.764846 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:49:16.768899 [debug] [ThreadPool]: Acquiring new postgres connection 'list_energyops'
[0m15:49:16.793092 [debug] [ThreadPool]: Using postgres connection "list_energyops"
[0m15:49:16.810083 [debug] [ThreadPool]: On list_energyops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "list_energyops"} */

    select distinct nspname from pg_namespace
  
[0m15:49:16.814649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:16.826484 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m15:49:16.831820 [debug] [ThreadPool]: On list_energyops: Close
[0m15:49:16.834662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_energyops, now list_energyops_analytics)
[0m15:49:16.840135 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:49:16.845443 [debug] [ThreadPool]: On list_energyops_analytics: BEGIN
[0m15:49:16.846682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:16.852822 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m15:49:16.855303 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:49:16.860338 [debug] [ThreadPool]: On list_energyops_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "list_energyops_analytics"} */
select
      'energyops' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:49:16.864239 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m15:49:16.867406 [debug] [ThreadPool]: On list_energyops_analytics: ROLLBACK
[0m15:49:16.870657 [debug] [ThreadPool]: On list_energyops_analytics: Close
[0m15:49:16.876116 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:16.876841 [debug] [MainThread]: On master: BEGIN
[0m15:49:16.877517 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:16.881164 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:49:16.881725 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:16.882223 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:49:16.884972 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m15:49:16.886140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5809bb6e-88fa-4ff4-a5e4-4d88aa6dcdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d013ed4f0>]}
[0m15:49:16.886926 [debug] [MainThread]: On master: ROLLBACK
[0m15:49:16.887584 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:16.888447 [debug] [MainThread]: On master: BEGIN
[0m15:49:16.889255 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:49:16.890024 [debug] [MainThread]: On master: COMMIT
[0m15:49:16.890524 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:16.890979 [debug] [MainThread]: On master: COMMIT
[0m15:49:16.891480 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:49:16.891913 [debug] [MainThread]: On master: Close
[0m15:49:16.893674 [debug] [Thread-1 (]: Began running node model.energyops.stg_supplier_meter_readings
[0m15:49:16.894345 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stg_supplier_meter_readings .............. [RUN]
[0m15:49:16.895025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_energyops_analytics, now model.energyops.stg_supplier_meter_readings)
[0m15:49:16.895586 [debug] [Thread-1 (]: Began compiling node model.energyops.stg_supplier_meter_readings
[0m15:49:16.900303 [debug] [Thread-1 (]: Writing injected SQL for node "model.energyops.stg_supplier_meter_readings"
[0m15:49:16.905907 [debug] [Thread-1 (]: Began executing node model.energyops.stg_supplier_meter_readings
[0m15:49:16.926563 [debug] [Thread-1 (]: Writing runtime sql for node "model.energyops.stg_supplier_meter_readings"
[0m15:49:16.931059 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:49:16.931759 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: BEGIN
[0m15:49:16.932352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:16.936173 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:49:16.936807 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:49:16.937320 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */

  create view "energyops"."analytics"."stg_supplier_meter_readings__dbt_tmp"
    
    
  as (
    select
  period_start,
  period_end,
  trim(reading_type) as reading_type,
  upper(trim(cadran)) as cadran,
  index_start,
  index_end,
  kwh::numeric(12,3) as kwh,
  (period_end - period_start + 1) as period_days
from raw.supplier_meter_readings
  );
[0m15:49:16.938997 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:49:16.943119 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:49:16.943708 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
alter table "energyops"."analytics"."stg_supplier_meter_readings" rename to "stg_supplier_meter_readings__dbt_backup"
[0m15:49:16.944489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:49:16.946473 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:49:16.947050 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
alter table "energyops"."analytics"."stg_supplier_meter_readings__dbt_tmp" rename to "stg_supplier_meter_readings"
[0m15:49:16.947863 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:49:16.957689 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: COMMIT
[0m15:49:16.958423 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:49:16.958989 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: COMMIT
[0m15:49:16.961802 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:49:16.965792 [debug] [Thread-1 (]: Applying DROP to: "energyops"."analytics"."stg_supplier_meter_readings__dbt_backup"
[0m15:49:16.976673 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:49:16.977911 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
drop view if exists "energyops"."analytics"."stg_supplier_meter_readings__dbt_backup" cascade
[0m15:49:16.982704 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m15:49:16.985658 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: Close
[0m15:49:16.988424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5809bb6e-88fa-4ff4-a5e4-4d88aa6dcdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d24e2e7b0>]}
[0m15:49:16.989656 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stg_supplier_meter_readings ......... [[32mCREATE VIEW[0m in 0.09s]
[0m15:49:16.990930 [debug] [Thread-1 (]: Finished running node model.energyops.stg_supplier_meter_readings
[0m15:49:16.992358 [debug] [Thread-3 (]: Began running node model.energyops.fct_energy_period
[0m15:49:16.993370 [info ] [Thread-3 (]: 2 of 3 START sql table model analytics.fct_energy_period ....................... [RUN]
[0m15:49:16.994287 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.energyops.fct_energy_period'
[0m15:49:16.997311 [debug] [Thread-3 (]: Began compiling node model.energyops.fct_energy_period
[0m15:49:16.999910 [debug] [Thread-3 (]: Writing injected SQL for node "model.energyops.fct_energy_period"
[0m15:49:17.008218 [debug] [Thread-3 (]: Began executing node model.energyops.fct_energy_period
[0m15:49:17.021800 [debug] [Thread-3 (]: Writing runtime sql for node "model.energyops.fct_energy_period"
[0m15:49:17.028170 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:49:17.028933 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: BEGIN
[0m15:49:17.029660 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:49:17.033930 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m15:49:17.034794 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:49:17.035614 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */

  
    

  create  table "energyops"."analytics"."fct_energy_period__dbt_tmp"
  
  
    as
  
  (
    with base as (
  select
    period_start,
    period_end,
    max(period_days) as period_days,
    sum(kwh) filter (where cadran = 'HP') as kwh_hp,
    sum(kwh) filter (where cadran = 'HC') as kwh_hc
  from "energyops"."analytics"."stg_supplier_meter_readings"
  group by 1,2
),
tar as (
  select
    b.*,
    t.hp_eur_per_kwh,
    t.hc_eur_per_kwh
  from base b
  left join lateral (
    select hp_eur_per_kwh, hc_eur_per_kwh
    from config.tariff_hp_hc
    where effective_from <= b.period_end
    order by effective_from desc
    limit 1
  ) t on true
)
select
  period_start,
  period_end,
  period_days,
  coalesce(kwh_hp, 0) as kwh_hp,
  coalesce(kwh_hc, 0) as kwh_hc,
  (coalesce(kwh_hp,0) + coalesce(kwh_hc,0)) as kwh_total,
  ((coalesce(kwh_hp,0) + coalesce(kwh_hc,0)) / nullif(period_days,0))::numeric(12,3) as kwh_per_day_est,
  hp_eur_per_kwh,
  hc_eur_per_kwh,
  (coalesce(kwh_hp,0) * hp_eur_per_kwh + coalesce(kwh_hc,0) * hc_eur_per_kwh)::numeric(12,2) as cost_est_eur
from tar
order by period_end
  );
  
[0m15:49:17.043185 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.007 seconds
[0m15:49:17.045659 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:49:17.046423 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
alter table "energyops"."analytics"."fct_energy_period" rename to "fct_energy_period__dbt_backup"
[0m15:49:17.047315 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:49:17.050393 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:49:17.051009 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
alter table "energyops"."analytics"."fct_energy_period__dbt_tmp" rename to "fct_energy_period"
[0m15:49:17.051776 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:49:17.055048 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: COMMIT
[0m15:49:17.055690 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:49:17.056221 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: COMMIT
[0m15:49:17.059635 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m15:49:17.061416 [debug] [Thread-3 (]: Applying DROP to: "energyops"."analytics"."fct_energy_period__dbt_backup"
[0m15:49:17.063731 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:49:17.064349 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
drop table if exists "energyops"."analytics"."fct_energy_period__dbt_backup" cascade
[0m15:49:17.067896 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:49:17.069030 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: Close
[0m15:49:17.069785 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5809bb6e-88fa-4ff4-a5e4-4d88aa6dcdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d012cbb90>]}
[0m15:49:17.070544 [info ] [Thread-3 (]: 2 of 3 OK created sql table model analytics.fct_energy_period .................. [[32mSELECT 2[0m in 0.08s]
[0m15:49:17.071396 [debug] [Thread-3 (]: Finished running node model.energyops.fct_energy_period
[0m15:49:17.072499 [debug] [Thread-2 (]: Began running node model.energyops.agg_energy_calendar_month_est
[0m15:49:17.073222 [info ] [Thread-2 (]: 3 of 3 START sql table model analytics.agg_energy_calendar_month_est ........... [RUN]
[0m15:49:17.074023 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.energyops.agg_energy_calendar_month_est'
[0m15:49:17.074625 [debug] [Thread-2 (]: Began compiling node model.energyops.agg_energy_calendar_month_est
[0m15:49:17.076478 [debug] [Thread-2 (]: Writing injected SQL for node "model.energyops.agg_energy_calendar_month_est"
[0m15:49:17.080184 [debug] [Thread-2 (]: Began executing node model.energyops.agg_energy_calendar_month_est
[0m15:49:17.082279 [debug] [Thread-2 (]: Writing runtime sql for node "model.energyops.agg_energy_calendar_month_est"
[0m15:49:17.085957 [debug] [Thread-2 (]: Using postgres connection "model.energyops.agg_energy_calendar_month_est"
[0m15:49:17.086593 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: BEGIN
[0m15:49:17.087161 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:49:17.091459 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m15:49:17.092175 [debug] [Thread-2 (]: Using postgres connection "model.energyops.agg_energy_calendar_month_est"
[0m15:49:17.092792 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.agg_energy_calendar_month_est"} */

  
    

  create  table "energyops"."analytics"."agg_energy_calendar_month_est__dbt_tmp"
  
  
    as
  
  (
    with p as (
  select * from "energyops"."analytics"."fct_energy_period"
),
per_day as (
  select
    gs::date as day,
    (p.kwh_hp / nullif(p.period_days,0)) as kwh_hp,
    (p.kwh_hc / nullif(p.period_days,0)) as kwh_hc
  from p
  cross join lateral generate_series(p.period_start, p.period_end, interval '1 day') gs
)
select
  date_trunc('month', day)::date as month,
  sum(kwh_hp)::numeric(12,2) as kwh_hp_month,
  sum(kwh_hc)::numeric(12,2) as kwh_hc_month,
  sum(kwh_hp + kwh_hc)::numeric(12,2) as kwh_total_month
group by 1
order by 1
  );
  
[0m15:49:17.093938 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "day" does not exist
LINE 24:   date_trunc('month', day)::date as month,
                               ^

[0m15:49:17.094522 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: ROLLBACK
[0m15:49:17.095308 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: Close
[0m15:49:17.097691 [debug] [Thread-2 (]: Database Error in model agg_energy_calendar_month_est (models/marts/agg_energy_calendar_month_est.sql)
  column "day" does not exist
  LINE 24:   date_trunc('month', day)::date as month,
                                 ^
  compiled code at target/run/energyops/models/marts/agg_energy_calendar_month_est.sql
[0m15:49:17.098468 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5809bb6e-88fa-4ff4-a5e4-4d88aa6dcdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d012cdd90>]}
[0m15:49:17.099327 [error] [Thread-2 (]: 3 of 3 ERROR creating sql table model analytics.agg_energy_calendar_month_est .. [[31mERROR[0m in 0.02s]
[0m15:49:17.100149 [debug] [Thread-2 (]: Finished running node model.energyops.agg_energy_calendar_month_est
[0m15:49:17.100935 [debug] [Thread-7 (]: Marking all children of 'model.energyops.agg_energy_calendar_month_est' to be skipped because of status 'error'.  Reason: Database Error in model agg_energy_calendar_month_est (models/marts/agg_energy_calendar_month_est.sql)
  column "day" does not exist
  LINE 24:   date_trunc('month', day)::date as month,
                                 ^
  compiled code at target/run/energyops/models/marts/agg_energy_calendar_month_est.sql.
[0m15:49:17.102744 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:17.103543 [debug] [MainThread]: On master: BEGIN
[0m15:49:17.104092 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:49:17.108221 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:49:17.108893 [debug] [MainThread]: On master: COMMIT
[0m15:49:17.109509 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:17.110096 [debug] [MainThread]: On master: COMMIT
[0m15:49:17.110791 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:49:17.111456 [debug] [MainThread]: On master: Close
[0m15:49:17.112183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:17.112876 [debug] [MainThread]: Connection 'model.energyops.stg_supplier_meter_readings' was properly closed.
[0m15:49:17.113487 [debug] [MainThread]: Connection 'model.energyops.fct_energy_period' was properly closed.
[0m15:49:17.114001 [debug] [MainThread]: Connection 'model.energyops.agg_energy_calendar_month_est' was properly closed.
[0m15:49:17.114629 [info ] [MainThread]: 
[0m15:49:17.115476 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:49:17.116870 [debug] [MainThread]: Command end result
[0m15:49:17.135925 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:49:17.139049 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:49:17.146383 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:49:17.147470 [info ] [MainThread]: 
[0m15:49:17.150245 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:49:17.151311 [info ] [MainThread]: 
[0m15:49:17.152821 [error] [MainThread]:   Database Error in model agg_energy_calendar_month_est (models/marts/agg_energy_calendar_month_est.sql)
  column "day" does not exist
  LINE 24:   date_trunc('month', day)::date as month,
                                 ^
  compiled code at target/run/energyops/models/marts/agg_energy_calendar_month_est.sql
[0m15:49:17.154802 [info ] [MainThread]: 
[0m15:49:17.157320 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:49:17.158509 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0799071, "process_in_blocks": "0", "process_kernel_time": 0.171556, "process_mem_max_rss": "112448", "process_out_blocks": "1608", "process_user_time": 1.424315}
[0m15:49:17.159227 [debug] [MainThread]: Command `dbt run` failed at 15:49:17.159110 after 1.08 seconds
[0m15:49:17.159792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d234477d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d243f9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1d012a89b0>]}
[0m15:49:17.160322 [debug] [MainThread]: Flushing usage events
[0m15:49:17.562251 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:50:06.532121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce9a8b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce9c3af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce9a89a00>]}


============================== 15:50:06.537692 | 4899b13b-f83d-40b9-ace3-de2850273112 ==============================
[0m15:50:06.537692 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:50:06.538498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:50:06.674233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4899b13b-f83d-40b9-ace3-de2850273112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce9a8a210>]}
[0m15:50:06.714599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4899b13b-f83d-40b9-ace3-de2850273112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cea21b1a0>]}
[0m15:50:06.715940 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:50:06.758587 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:50:06.873505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:06.874302 [debug] [MainThread]: Partial parsing: updated file: energyops://models/marts/agg_energy_calendar_month_est.sql
[0m15:50:07.048817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4899b13b-f83d-40b9-ace3-de2850273112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce78f1a60>]}
[0m15:50:07.097989 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:50:07.102003 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:50:07.120446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4899b13b-f83d-40b9-ace3-de2850273112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce7a53da0>]}
[0m15:50:07.122599 [info ] [MainThread]: Found 3 models, 4 data tests, 429 macros
[0m15:50:07.125331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4899b13b-f83d-40b9-ace3-de2850273112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce7a0fe30>]}
[0m15:50:07.127843 [info ] [MainThread]: 
[0m15:50:07.130433 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:50:07.131462 [info ] [MainThread]: 
[0m15:50:07.132803 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:07.136236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_energyops'
[0m15:50:07.158808 [debug] [ThreadPool]: Using postgres connection "list_energyops"
[0m15:50:07.159697 [debug] [ThreadPool]: On list_energyops: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "list_energyops"} */

    select distinct nspname from pg_namespace
  
[0m15:50:07.160467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:07.166603 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m15:50:07.168379 [debug] [ThreadPool]: On list_energyops: Close
[0m15:50:07.170220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_energyops, now list_energyops_analytics)
[0m15:50:07.174285 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:50:07.174864 [debug] [ThreadPool]: On list_energyops_analytics: BEGIN
[0m15:50:07.175344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:07.179105 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:50:07.179723 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:50:07.180233 [debug] [ThreadPool]: On list_energyops_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "list_energyops_analytics"} */
select
      'energyops' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:50:07.182321 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m15:50:07.183366 [debug] [ThreadPool]: On list_energyops_analytics: ROLLBACK
[0m15:50:07.183965 [debug] [ThreadPool]: On list_energyops_analytics: Close
[0m15:50:07.187258 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:07.187770 [debug] [MainThread]: On master: BEGIN
[0m15:50:07.188226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:07.191726 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:50:07.192300 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:07.192840 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:07.195529 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m15:50:07.196745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4899b13b-f83d-40b9-ace3-de2850273112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce94a35c0>]}
[0m15:50:07.197376 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:07.198042 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:07.198523 [debug] [MainThread]: On master: BEGIN
[0m15:50:07.199175 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:50:07.199670 [debug] [MainThread]: On master: COMMIT
[0m15:50:07.200113 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:07.200575 [debug] [MainThread]: On master: COMMIT
[0m15:50:07.201182 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:50:07.201656 [debug] [MainThread]: On master: Close
[0m15:50:07.203565 [debug] [Thread-1 (]: Began running node model.energyops.stg_supplier_meter_readings
[0m15:50:07.204338 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stg_supplier_meter_readings .............. [RUN]
[0m15:50:07.205883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_energyops_analytics, now model.energyops.stg_supplier_meter_readings)
[0m15:50:07.206763 [debug] [Thread-1 (]: Began compiling node model.energyops.stg_supplier_meter_readings
[0m15:50:07.211527 [debug] [Thread-1 (]: Writing injected SQL for node "model.energyops.stg_supplier_meter_readings"
[0m15:50:07.215737 [debug] [Thread-1 (]: Began executing node model.energyops.stg_supplier_meter_readings
[0m15:50:07.236627 [debug] [Thread-1 (]: Writing runtime sql for node "model.energyops.stg_supplier_meter_readings"
[0m15:50:07.263195 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:50:07.276898 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: BEGIN
[0m15:50:07.288614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:07.308969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m15:50:07.310898 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:50:07.311868 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */

  create view "energyops"."analytics"."stg_supplier_meter_readings__dbt_tmp"
    
    
  as (
    select
  period_start,
  period_end,
  trim(reading_type) as reading_type,
  upper(trim(cadran)) as cadran,
  index_start,
  index_end,
  kwh::numeric(12,3) as kwh,
  (period_end - period_start + 1) as period_days
from raw.supplier_meter_readings
  );
[0m15:50:07.313812 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m15:50:07.318965 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:50:07.320894 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
alter table "energyops"."analytics"."stg_supplier_meter_readings" rename to "stg_supplier_meter_readings__dbt_backup"
[0m15:50:07.322060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:50:07.324297 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:50:07.325682 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
alter table "energyops"."analytics"."stg_supplier_meter_readings__dbt_tmp" rename to "stg_supplier_meter_readings"
[0m15:50:07.327110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:50:07.339315 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: COMMIT
[0m15:50:07.344707 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:50:07.346365 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: COMMIT
[0m15:50:07.363017 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m15:50:07.368177 [debug] [Thread-1 (]: Applying DROP to: "energyops"."analytics"."stg_supplier_meter_readings__dbt_backup"
[0m15:50:07.372292 [debug] [Thread-1 (]: Using postgres connection "model.energyops.stg_supplier_meter_readings"
[0m15:50:07.373063 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.stg_supplier_meter_readings"} */
drop view if exists "energyops"."analytics"."stg_supplier_meter_readings__dbt_backup" cascade
[0m15:50:07.376676 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:50:07.378612 [debug] [Thread-1 (]: On model.energyops.stg_supplier_meter_readings: Close
[0m15:50:07.380154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4899b13b-f83d-40b9-ace3-de2850273112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ceb452780>]}
[0m15:50:07.381076 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stg_supplier_meter_readings ......... [[32mCREATE VIEW[0m in 0.17s]
[0m15:50:07.382122 [debug] [Thread-1 (]: Finished running node model.energyops.stg_supplier_meter_readings
[0m15:50:07.383387 [debug] [Thread-3 (]: Began running node model.energyops.fct_energy_period
[0m15:50:07.384213 [info ] [Thread-3 (]: 2 of 3 START sql table model analytics.fct_energy_period ....................... [RUN]
[0m15:50:07.385145 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.energyops.fct_energy_period'
[0m15:50:07.385943 [debug] [Thread-3 (]: Began compiling node model.energyops.fct_energy_period
[0m15:50:07.388198 [debug] [Thread-3 (]: Writing injected SQL for node "model.energyops.fct_energy_period"
[0m15:50:07.393595 [debug] [Thread-3 (]: Began executing node model.energyops.fct_energy_period
[0m15:50:07.406082 [debug] [Thread-3 (]: Writing runtime sql for node "model.energyops.fct_energy_period"
[0m15:50:07.410527 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:50:07.411166 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: BEGIN
[0m15:50:07.411726 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:50:07.416026 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m15:50:07.416854 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:50:07.417461 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */

  
    

  create  table "energyops"."analytics"."fct_energy_period__dbt_tmp"
  
  
    as
  
  (
    with base as (
  select
    period_start,
    period_end,
    max(period_days) as period_days,
    sum(kwh) filter (where cadran = 'HP') as kwh_hp,
    sum(kwh) filter (where cadran = 'HC') as kwh_hc
  from "energyops"."analytics"."stg_supplier_meter_readings"
  group by 1,2
),
tar as (
  select
    b.*,
    t.hp_eur_per_kwh,
    t.hc_eur_per_kwh
  from base b
  left join lateral (
    select hp_eur_per_kwh, hc_eur_per_kwh
    from config.tariff_hp_hc
    where effective_from <= b.period_end
    order by effective_from desc
    limit 1
  ) t on true
)
select
  period_start,
  period_end,
  period_days,
  coalesce(kwh_hp, 0) as kwh_hp,
  coalesce(kwh_hc, 0) as kwh_hc,
  (coalesce(kwh_hp,0) + coalesce(kwh_hc,0)) as kwh_total,
  ((coalesce(kwh_hp,0) + coalesce(kwh_hc,0)) / nullif(period_days,0))::numeric(12,3) as kwh_per_day_est,
  hp_eur_per_kwh,
  hc_eur_per_kwh,
  (coalesce(kwh_hp,0) * hp_eur_per_kwh + coalesce(kwh_hc,0) * hc_eur_per_kwh)::numeric(12,2) as cost_est_eur
from tar
order by period_end
  );
  
[0m15:50:07.427867 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.010 seconds
[0m15:50:07.430743 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:50:07.431619 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
alter table "energyops"."analytics"."fct_energy_period" rename to "fct_energy_period__dbt_backup"
[0m15:50:07.432590 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:50:07.435764 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:50:07.436552 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
alter table "energyops"."analytics"."fct_energy_period__dbt_tmp" rename to "fct_energy_period"
[0m15:50:07.437469 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:50:07.440981 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: COMMIT
[0m15:50:07.441738 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:50:07.442414 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: COMMIT
[0m15:50:07.445433 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:50:07.447284 [debug] [Thread-3 (]: Applying DROP to: "energyops"."analytics"."fct_energy_period__dbt_backup"
[0m15:50:07.449829 [debug] [Thread-3 (]: Using postgres connection "model.energyops.fct_energy_period"
[0m15:50:07.450613 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.fct_energy_period"} */
drop table if exists "energyops"."analytics"."fct_energy_period__dbt_backup" cascade
[0m15:50:07.454178 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:50:07.455501 [debug] [Thread-3 (]: On model.energyops.fct_energy_period: Close
[0m15:50:07.456365 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4899b13b-f83d-40b9-ace3-de2850273112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce41c7620>]}
[0m15:50:07.457185 [info ] [Thread-3 (]: 2 of 3 OK created sql table model analytics.fct_energy_period .................. [[32mSELECT 2[0m in 0.07s]
[0m15:50:07.458072 [debug] [Thread-3 (]: Finished running node model.energyops.fct_energy_period
[0m15:50:07.459167 [debug] [Thread-2 (]: Began running node model.energyops.agg_energy_calendar_month_est
[0m15:50:07.459909 [info ] [Thread-2 (]: 3 of 3 START sql table model analytics.agg_energy_calendar_month_est ........... [RUN]
[0m15:50:07.460804 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.energyops.agg_energy_calendar_month_est'
[0m15:50:07.461590 [debug] [Thread-2 (]: Began compiling node model.energyops.agg_energy_calendar_month_est
[0m15:50:07.463735 [debug] [Thread-2 (]: Writing injected SQL for node "model.energyops.agg_energy_calendar_month_est"
[0m15:50:07.467812 [debug] [Thread-2 (]: Began executing node model.energyops.agg_energy_calendar_month_est
[0m15:50:07.469981 [debug] [Thread-2 (]: Writing runtime sql for node "model.energyops.agg_energy_calendar_month_est"
[0m15:50:07.476754 [debug] [Thread-2 (]: Using postgres connection "model.energyops.agg_energy_calendar_month_est"
[0m15:50:07.477800 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: BEGIN
[0m15:50:07.481231 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:50:07.485794 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m15:50:07.486786 [debug] [Thread-2 (]: Using postgres connection "model.energyops.agg_energy_calendar_month_est"
[0m15:50:07.487525 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.agg_energy_calendar_month_est"} */

  
    

  create  table "energyops"."analytics"."agg_energy_calendar_month_est__dbt_tmp"
  
  
    as
  
  (
    with base as (
  select
    period_start,
    period_end,
    period_days,
    kwh_hp,
    kwh_hc,
    kwh_total,
    cost_est_eur
  from "energyops"."analytics"."fct_energy_period"
),

monthly as (
  select
    date_trunc('month', period_end)::date as month,
    sum(kwh_hp) as kwh_hp,
    sum(kwh_hc) as kwh_hc,
    sum(kwh_total) as kwh_total,
    sum(cost_est_eur) as cost_est_eur,
    sum(period_days) as days_covered,
    (sum(kwh_total) / nullif(sum(period_days), 0))::numeric(12,3) as kwh_per_day_est
  from base
  group by 1
)

select
  month,
  kwh_hp,
  kwh_hc,
  kwh_total,
  cost_est_eur,
  days_covered,
  kwh_per_day_est
from monthly
order by month
  );
  
[0m15:50:07.494931 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.007 seconds
[0m15:50:07.497662 [debug] [Thread-2 (]: Using postgres connection "model.energyops.agg_energy_calendar_month_est"
[0m15:50:07.498563 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.agg_energy_calendar_month_est"} */
alter table "energyops"."analytics"."agg_energy_calendar_month_est__dbt_tmp" rename to "agg_energy_calendar_month_est"
[0m15:50:07.499595 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:50:07.500976 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: COMMIT
[0m15:50:07.501931 [debug] [Thread-2 (]: Using postgres connection "model.energyops.agg_energy_calendar_month_est"
[0m15:50:07.502679 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: COMMIT
[0m15:50:07.506091 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m15:50:07.507999 [debug] [Thread-2 (]: Applying DROP to: "energyops"."analytics"."agg_energy_calendar_month_est__dbt_backup"
[0m15:50:07.509647 [debug] [Thread-2 (]: Using postgres connection "model.energyops.agg_energy_calendar_month_est"
[0m15:50:07.510489 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "model.energyops.agg_energy_calendar_month_est"} */
drop table if exists "energyops"."analytics"."agg_energy_calendar_month_est__dbt_backup" cascade
[0m15:50:07.511459 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:50:07.512812 [debug] [Thread-2 (]: On model.energyops.agg_energy_calendar_month_est: Close
[0m15:50:07.513729 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4899b13b-f83d-40b9-ace3-de2850273112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce4174800>]}
[0m15:50:07.514703 [info ] [Thread-2 (]: 3 of 3 OK created sql table model analytics.agg_energy_calendar_month_est ...... [[32mSELECT 2[0m in 0.05s]
[0m15:50:07.515545 [debug] [Thread-2 (]: Finished running node model.energyops.agg_energy_calendar_month_est
[0m15:50:07.518513 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:07.519201 [debug] [MainThread]: On master: BEGIN
[0m15:50:07.519781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:07.524198 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:50:07.525164 [debug] [MainThread]: On master: COMMIT
[0m15:50:07.525859 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:07.526497 [debug] [MainThread]: On master: COMMIT
[0m15:50:07.527289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:50:07.527881 [debug] [MainThread]: On master: Close
[0m15:50:07.528756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:07.529343 [debug] [MainThread]: Connection 'model.energyops.stg_supplier_meter_readings' was properly closed.
[0m15:50:07.530029 [debug] [MainThread]: Connection 'model.energyops.fct_energy_period' was properly closed.
[0m15:50:07.530697 [debug] [MainThread]: Connection 'model.energyops.agg_energy_calendar_month_est' was properly closed.
[0m15:50:07.531519 [info ] [MainThread]: 
[0m15:50:07.532447 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m15:50:07.533654 [debug] [MainThread]: Command end result
[0m15:50:07.555181 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:50:07.559334 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:50:07.571819 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:50:07.573146 [info ] [MainThread]: 
[0m15:50:07.574142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:50:07.575236 [info ] [MainThread]: 
[0m15:50:07.576410 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:50:07.577914 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0849111, "process_in_blocks": "0", "process_kernel_time": 0.154916, "process_mem_max_rss": "112032", "process_out_blocks": "1608", "process_user_time": 1.473695}
[0m15:50:07.578856 [debug] [MainThread]: Command `dbt run` succeeded at 15:50:07.578761 after 1.09 seconds
[0m15:50:07.579958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce951fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ce94cdb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ceaedc0e0>]}
[0m15:50:07.580939 [debug] [MainThread]: Flushing usage events
[0m15:50:07.953245 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:50:09.899893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4903a2ad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e49032d9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4904d6dd60>]}


============================== 15:50:09.904315 | c69e4233-50d6-4cb8-ae11-44e54c907d41 ==============================
[0m15:50:09.904315 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:50:09.905200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:50:10.046014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c69e4233-50d6-4cb8-ae11-44e54c907d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4902e8be30>]}
[0m15:50:10.098986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c69e4233-50d6-4cb8-ae11-44e54c907d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4902eb6990>]}
[0m15:50:10.108547 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:50:10.157272 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:50:10.499222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:50:10.508833 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:50:10.548263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c69e4233-50d6-4cb8-ae11-44e54c907d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4902eb5d90>]}
[0m15:50:10.695415 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:50:10.708572 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:50:10.754533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c69e4233-50d6-4cb8-ae11-44e54c907d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4900f926f0>]}
[0m15:50:10.756506 [info ] [MainThread]: Found 3 models, 4 data tests, 429 macros
[0m15:50:10.760577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c69e4233-50d6-4cb8-ae11-44e54c907d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4902eb4380>]}
[0m15:50:10.764379 [info ] [MainThread]: 
[0m15:50:10.765700 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:50:10.766918 [info ] [MainThread]: 
[0m15:50:10.768192 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:10.772070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_energyops_analytics'
[0m15:50:10.795987 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:50:10.797125 [debug] [ThreadPool]: On list_energyops_analytics: BEGIN
[0m15:50:10.798045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:10.804351 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m15:50:10.805581 [debug] [ThreadPool]: Using postgres connection "list_energyops_analytics"
[0m15:50:10.806458 [debug] [ThreadPool]: On list_energyops_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "list_energyops_analytics"} */
select
      'energyops' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'energyops' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:50:10.809760 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m15:50:10.812575 [debug] [ThreadPool]: On list_energyops_analytics: ROLLBACK
[0m15:50:10.815535 [debug] [ThreadPool]: On list_energyops_analytics: Close
[0m15:50:10.819964 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:10.822885 [debug] [MainThread]: On master: BEGIN
[0m15:50:10.824213 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:10.830115 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:50:10.831115 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:10.832676 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:10.836472 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m15:50:10.839638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c69e4233-50d6-4cb8-ae11-44e54c907d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4902e8b620>]}
[0m15:50:10.841985 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:10.844992 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:10.847304 [debug] [MainThread]: On master: BEGIN
[0m15:50:10.850268 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:50:10.852256 [debug] [MainThread]: On master: COMMIT
[0m15:50:10.854061 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:10.859189 [debug] [MainThread]: On master: COMMIT
[0m15:50:10.861071 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:50:10.863162 [debug] [MainThread]: On master: Close
[0m15:50:10.866301 [debug] [Thread-1 (]: Began running node test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90
[0m15:50:10.866609 [debug] [Thread-2 (]: Began running node test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3
[0m15:50:10.866890 [debug] [Thread-3 (]: Began running node test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247
[0m15:50:10.867143 [debug] [Thread-4 (]: Began running node test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff
[0m15:50:10.867730 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_supplier_meter_readings_cadran .................. [RUN]
[0m15:50:10.868962 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_supplier_meter_readings_kwh ..................... [RUN]
[0m15:50:10.871248 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_supplier_meter_readings_period_end .............. [RUN]
[0m15:50:10.873532 [info ] [Thread-4 (]: 4 of 4 START test not_null_stg_supplier_meter_readings_period_start ............ [RUN]
[0m15:50:10.874771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_energyops_analytics, now test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90)
[0m15:50:10.876923 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3'
[0m15:50:10.879283 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247'
[0m15:50:10.880551 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff'
[0m15:50:10.881930 [debug] [Thread-1 (]: Began compiling node test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90
[0m15:50:10.882928 [debug] [Thread-2 (]: Began compiling node test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3
[0m15:50:10.885235 [debug] [Thread-3 (]: Began compiling node test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247
[0m15:50:10.888483 [debug] [Thread-4 (]: Began compiling node test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff
[0m15:50:10.900784 [debug] [Thread-1 (]: Writing injected SQL for node "test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90"
[0m15:50:10.904835 [debug] [Thread-2 (]: Writing injected SQL for node "test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3"
[0m15:50:10.909254 [debug] [Thread-3 (]: Writing injected SQL for node "test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247"
[0m15:50:10.912607 [debug] [Thread-4 (]: Writing injected SQL for node "test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff"
[0m15:50:10.922512 [debug] [Thread-1 (]: Began executing node test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90
[0m15:50:10.922877 [debug] [Thread-3 (]: Began executing node test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247
[0m15:50:10.928932 [debug] [Thread-4 (]: Began executing node test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff
[0m15:50:10.933905 [debug] [Thread-1 (]: Writing runtime sql for node "test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90"
[0m15:50:10.934276 [debug] [Thread-2 (]: Began executing node test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3
[0m15:50:10.937251 [debug] [Thread-3 (]: Writing runtime sql for node "test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247"
[0m15:50:10.942140 [debug] [Thread-4 (]: Writing runtime sql for node "test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff"
[0m15:50:10.947076 [debug] [Thread-2 (]: Writing runtime sql for node "test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3"
[0m15:50:10.953199 [debug] [Thread-1 (]: Using postgres connection "test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90"
[0m15:50:10.954578 [debug] [Thread-1 (]: On test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90: BEGIN
[0m15:50:10.955002 [debug] [Thread-3 (]: Using postgres connection "test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247"
[0m15:50:10.955362 [debug] [Thread-4 (]: Using postgres connection "test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff"
[0m15:50:10.956525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:10.957639 [debug] [Thread-2 (]: Using postgres connection "test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3"
[0m15:50:10.957905 [debug] [Thread-3 (]: On test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247: BEGIN
[0m15:50:10.959241 [debug] [Thread-4 (]: On test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff: BEGIN
[0m15:50:10.963280 [debug] [Thread-2 (]: On test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3: BEGIN
[0m15:50:10.964436 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:50:10.964910 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:50:10.965636 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:50:10.968437 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:50:10.971906 [debug] [Thread-1 (]: Using postgres connection "test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90"
[0m15:50:10.974131 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m15:50:10.979051 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m15:50:10.979955 [debug] [Thread-1 (]: On test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cadran
from "energyops"."analytics"."stg_supplier_meter_readings"
where cadran is null



      
    ) dbt_internal_test
[0m15:50:10.981804 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m15:50:10.982342 [debug] [Thread-3 (]: Using postgres connection "test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247"
[0m15:50:10.983831 [debug] [Thread-4 (]: Using postgres connection "test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff"
[0m15:50:10.986219 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:50:10.986499 [debug] [Thread-2 (]: Using postgres connection "test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3"
[0m15:50:10.987497 [debug] [Thread-3 (]: On test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end
from "energyops"."analytics"."stg_supplier_meter_readings"
where period_end is null



      
    ) dbt_internal_test
[0m15:50:10.988387 [debug] [Thread-4 (]: On test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_start
from "energyops"."analytics"."stg_supplier_meter_readings"
where period_start is null



      
    ) dbt_internal_test
[0m15:50:10.991972 [debug] [Thread-1 (]: On test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90: ROLLBACK
[0m15:50:10.993161 [debug] [Thread-2 (]: On test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "energyops", "target_name": "dev", "node_id": "test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select kwh
from "energyops"."analytics"."stg_supplier_meter_readings"
where kwh is null



      
    ) dbt_internal_test
[0m15:50:10.996414 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:50:10.998159 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:50:10.999528 [debug] [Thread-1 (]: On test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90: Close
[0m15:50:11.002785 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:50:11.005341 [debug] [Thread-3 (]: On test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247: ROLLBACK
[0m15:50:11.007302 [debug] [Thread-4 (]: On test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff: ROLLBACK
[0m15:50:11.009126 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_supplier_meter_readings_cadran ........................ [[32mPASS[0m in 0.13s]
[0m15:50:11.010923 [debug] [Thread-2 (]: On test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3: ROLLBACK
[0m15:50:11.012645 [debug] [Thread-3 (]: On test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247: Close
[0m15:50:11.014239 [debug] [Thread-4 (]: On test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff: Close
[0m15:50:11.016892 [debug] [Thread-1 (]: Finished running node test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90
[0m15:50:11.020156 [debug] [Thread-2 (]: On test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3: Close
[0m15:50:11.021120 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_supplier_meter_readings_period_end .................... [[32mPASS[0m in 0.14s]
[0m15:50:11.022415 [info ] [Thread-4 (]: 4 of 4 PASS not_null_stg_supplier_meter_readings_period_start .................. [[32mPASS[0m in 0.14s]
[0m15:50:11.025618 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_supplier_meter_readings_kwh ........................... [[32mPASS[0m in 0.15s]
[0m15:50:11.027314 [debug] [Thread-3 (]: Finished running node test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247
[0m15:50:11.033464 [debug] [Thread-4 (]: Finished running node test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff
[0m15:50:11.034999 [debug] [Thread-2 (]: Finished running node test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3
[0m15:50:11.041390 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:11.044235 [debug] [MainThread]: On master: BEGIN
[0m15:50:11.047264 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:11.052392 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:50:11.054839 [debug] [MainThread]: On master: COMMIT
[0m15:50:11.056183 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:11.057641 [debug] [MainThread]: On master: COMMIT
[0m15:50:11.060352 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:50:11.062638 [debug] [MainThread]: On master: Close
[0m15:50:11.064583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:11.066439 [debug] [MainThread]: Connection 'test.energyops.not_null_stg_supplier_meter_readings_cadran.6cbf650c90' was properly closed.
[0m15:50:11.069057 [debug] [MainThread]: Connection 'test.energyops.not_null_stg_supplier_meter_readings_kwh.ed4d23d5b3' was properly closed.
[0m15:50:11.072730 [debug] [MainThread]: Connection 'test.energyops.not_null_stg_supplier_meter_readings_period_end.fe049e8247' was properly closed.
[0m15:50:11.074351 [debug] [MainThread]: Connection 'test.energyops.not_null_stg_supplier_meter_readings_period_start.d384c532ff' was properly closed.
[0m15:50:11.077825 [info ] [MainThread]: 
[0m15:50:11.079682 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m15:50:11.081647 [debug] [MainThread]: Command end result
[0m15:50:11.138805 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:50:11.152420 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:50:11.168230 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:50:11.169922 [info ] [MainThread]: 
[0m15:50:11.171577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:50:11.173223 [info ] [MainThread]: 
[0m15:50:11.174713 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:50:11.176485 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3136414, "process_in_blocks": "0", "process_kernel_time": 0.184793, "process_mem_max_rss": "109980", "process_out_blocks": "1608", "process_user_time": 1.249362}
[0m15:50:11.178128 [debug] [MainThread]: Command `dbt test` succeeded at 15:50:11.177983 after 1.32 seconds
[0m15:50:11.179412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e490313c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e49013adf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e49031c3ad0>]}
[0m15:50:11.181384 [debug] [MainThread]: Flushing usage events
[0m15:50:11.556342 [debug] [MainThread]: An error was encountered while trying to flush usage events
